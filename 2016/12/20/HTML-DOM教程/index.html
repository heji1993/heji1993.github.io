

<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    
    <meta name="author" content="何机">
    
    <meta name="description" content="DOM是W3C的标准，是与语言无关的通用的用于操作文档的一种技术规范。">
    
    <meta name="keywords" content="DOM,web前端,HTML-DOM, 何机的博客,何机,博客,blog,IT,技术">
    

    
    <link rel="alternative" href="atom.xml" title="何机的博客" type="application/atom+xml">
    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>HTML-DOM教程 | 何机的博客 · No pains,no gains</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script>
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <meta name="baidu-site-verification" content="SzJ3MGdmeo" />


    <meta name="360-site-verification" content="afe5dc96bbb8d111b618f78493b95bb8" />


    <!--<meta name="baidu-site-verification" content="SzJ3MGdmeo" />-->
    <!--<meta name="360-site-verification" content="afe5dc96bbb8d111b618f78493b95bb8" />-->

</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://heji1993.github.io" title="何机的博客">何机的博客</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                
                <ul class="nav navbar-nav pull-right">
                    <li>
                        <!--<a class="max-width max-w300" title="No pains,no gains" href="/feelings">No pains,no gains</a>-->
						<a class="max-width max-w300" title="No pains,no gains">No pains,no gains</a>
                    </li>
                </ul>
                

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index">
                        <a href="/" target="">首页</a>
                    </li>
                    
                    <li id="nav-archives">
                        <a href="/archives" target="">归档</a>
                    </li>
                    
                    <li id="nav-categories">
                        <a href="/categories" target="">分类</a>
                    </li>
                    
                    <li id="nav-tags">
                        <a href="/tags" target="">标签</a>
                    </li>
                    
                    <li id="nav-about">
                        <a href="/about" target="">关于</a>
                    </li>
                    

                    <li id="nav-github"><a href="https://github.com/heji1993" target="_blank">GitHub</a></li>
                    <!--<li id="nav-rss"><a href="/atom.xml" target="_blank">Rss</a></li>-->
                    <li id="nav-search"><input type="text" id="search" placeholder="search" /></li>
                </ul>
            </div>
        </div>
    </nav>

    <script>
    var bgRoot = "http://7xkwt1.com1.z0.glb.clouddn.com/background-";
    var bgLength = "74";
    var bgRandom = false;
    var bgImage = "/images/bg.jpg";

    $(function() {
        // page-id...
        var pageId = "2016/12/20/HTML-DOM教程/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";

        $("#nav-" + pageId).addClass("active");
    });
    </script>

    <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>HTML-DOM教程</h1>

        <div class="time-info">
            
<span class="article-tags">
    
    Tags: <a href="/tags/web前端/">web前端</a>&nbsp;<a href="/tags/DOM/">DOM</a>&nbsp;<a href="/tags/HTML-DOM/">HTML-DOM</a>&nbsp;
</span>



<span class="article-categories">
    Category:
    <a class="article-category-link" href="/categories/DOM/">DOM</a>
</span>


        </div>
        <div class="time-info">
            发表: <time datetime="2016-12-20T11:47:21.732Z"
                       itemprop="datePublished">2016-12-20</time>
            
            更新: <time datetime="2016-12-21T03:32:34.024Z"
                       itemprop="dateModified">2016-12-21</time>
            
        </div>

        <div class="post-body-inner">
            
                <div id="toc" class="toc-article well">
                    <strong class="toc-title">大纲</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#简介"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是DOM"><span class="toc-number">1.1.</span> <span class="toc-text">什么是DOM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#理解DOM-Level以及兼容性"><span class="toc-number">1.2.</span> <span class="toc-text">理解DOM Level以及兼容性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DOM-Level"><span class="toc-number">1.2.1.</span> <span class="toc-text">DOM Level</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#兼容性"><span class="toc-number">1.2.2.</span> <span class="toc-text">兼容性</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Document对象"><span class="toc-number">2.</span> <span class="toc-text">使用Document对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Document元数据"><span class="toc-number">2.1.</span> <span class="toc-text">使用Document元数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取HTML元素对象"><span class="toc-number">2.2.</span> <span class="toc-text">获取HTML元素对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#在DOM树里导航"><span class="toc-number">2.3.</span> <span class="toc-text">在DOM树里导航</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Window对象"><span class="toc-number">3.</span> <span class="toc-text">使用Window对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取window对象"><span class="toc-number">3.1.</span> <span class="toc-text">获取window对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取窗口信息"><span class="toc-number">3.2.</span> <span class="toc-text">获取窗口信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#与窗口进行交互"><span class="toc-number">3.3.</span> <span class="toc-text">与窗口进行交互</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对用户进行提示"><span class="toc-number">3.4.</span> <span class="toc-text">对用户进行提示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#获取基本信息"><span class="toc-number">3.5.</span> <span class="toc-text">获取基本信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用浏览器历史"><span class="toc-number">3.6.</span> <span class="toc-text">使用浏览器历史</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用跨文档消息传递（重要）"><span class="toc-number">3.7.</span> <span class="toc-text">使用跨文档消息传递（重要）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用计时器"><span class="toc-number">3.8.</span> <span class="toc-text">使用计时器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用DOM元素"><span class="toc-number">4.</span> <span class="toc-text">使用DOM元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用对象元素"><span class="toc-number">4.1.</span> <span class="toc-text">使用对象元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用Text对象"><span class="toc-number">4.2.</span> <span class="toc-text">使用Text对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改模型"><span class="toc-number">4.3.</span> <span class="toc-text">修改模型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为DOM元素设置样式"><span class="toc-number">5.</span> <span class="toc-text">为DOM元素设置样式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用样式表"><span class="toc-number">5.1.</span> <span class="toc-text">使用样式表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用元素样式"><span class="toc-number">5.2.</span> <span class="toc-text">使用元素样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用CSSStyleDeclaration对象"><span class="toc-number">5.3.</span> <span class="toc-text">使用CSSStyleDeclaration对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用计算样式"><span class="toc-number">5.4.</span> <span class="toc-text">使用计算样式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用事件"><span class="toc-number">6.</span> <span class="toc-text">使用事件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#使用简单事件处理器"><span class="toc-number">6.1.</span> <span class="toc-text">使用简单事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用DOM和事件对象"><span class="toc-number">6.2.</span> <span class="toc-text">使用DOM和事件对象</span></a></li></ol></li></ol>
                </div>
            

            <p>DOM是W3C的标准，是与语言无关的通用的用于操作文档的一种技术规范。</p>
<a id="more"></a>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><h3 id="什么是DOM"><a href="#什么是DOM" class="headerlink" title="什么是DOM"></a>什么是DOM</h3><p>DOM是W3C的标准。DOM定义了访问HTML和XML文档的标准：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&quot;W3C 文档对象模型 （DOM） 是中立于平台和语言的接口，它允许程序和脚本动态地访问和更新文档的内容、结构和样式。&quot;</div></pre></td></tr></table></figure></p>
<p>W3C DOM标准被分为3个不同的部分：</p>
<ul>
<li>核心DOM-针对任何结构化文档的标准模型</li>
<li>XMLDOM-针对XML文档的标准模型</li>
<li>HTMLDOM-针对HTML文档的标准模型</li>
</ul>
<p><strong>注：DOM是Document Object Model(文档对象模型)的缩写</strong></p>
<h3 id="理解DOM-Level以及兼容性"><a href="#理解DOM-Level以及兼容性" class="headerlink" title="理解DOM Level以及兼容性"></a>理解DOM Level以及兼容性</h3><h4 id="DOM-Level"><a href="#DOM-Level" class="headerlink" title="DOM Level"></a>DOM Level</h4><p>DOM的标准化不是一蹴而就的，而是一步步地改进完善。DOM Level本质上是DOM标准化过程中的不同版本。分为1级DOM、2级DOM、3级DOM以及“0级”DOM。</p>
<ul>
<li>1级DOM<br>1级DOM在1998年10月份成为W3C的提议，由DOM核心与DOM HTML两个模块组成。DOM核心能映射以XML为基础的文档结构，允许获取和操作文档的任意部分。DOM HTML通过添加HTML专用的对象与函数对DOM核心进行了扩展。</li>
<li>2级DOM<br>鉴于1级DOM仅以映射文档结构为目标，DOM 2级面向更为宽广。通过对原有DOM的扩展，2级DOM通过对象接口增加了对鼠标和用户界面事件（DHTML长期支持鼠标与用户界面事件）、范围、遍历（重复执行DOM文档）和层叠样式表（CSS）的支持。同时也对DOM 1的核心进行了扩展，从而可支持XML命名空间。</li>
<li>3级DOM<br>3级DOM通过引入统一方式载入和保存文档和文档验证方法对DOM进行进一步扩展，DOM3包含一个名为“DOM载入与保存”的新模块，DOM核心扩展后可支持XML1.0的所有内容，包括XML Infoset、 XPath、和XML Base。</li>
<li>“0级”DOM<br>当阅读与DOM有关的材料时，可能会遇到参考0级DOM的情况。需要注意的是并没有标准被称为0级DOM，它仅是DOM历史上一个参考点（0级DOM被认为是在Internet Explorer 4.0 与Netscape Navigator4.0支持的最早的DHTML）。</li>
</ul>
<h4 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h4><p>每一个DOM Level都有描述它的标准和文档，但他们并没有被完整地实现，浏览器只是简单地挑选了其中的有用功能，而且，已经实现的功能之间还存在某种程度的不一致性。<br>有多种方式应对DOM功能的多变性：</p>
<ol>
<li>使用JavaScript库<br>JavaScript库消除了浏览器之间实现方式的差别，优点是其一致性，缺点是只能使用库支持的那些功能。</li>
<li>保守方式<br>只使用你所知的被广泛支持的那些功能。</li>
<li><p>测试DOM功能<br> 第三种方式是测试与某一功能相关的DOM对象属性或方法是否存在。</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">var</span> images;</div><div class="line">    <span class="keyword">if</span>(<span class="built_in">document</span>.querySelectorAll)&#123;</div><div class="line">      images = <span class="built_in">document</span>.querySelectorAll(<span class="string">"#paratext &gt; img"</span>);</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">      images = <span class="built_in">document</span>.getElementById(<span class="string">"paratext"</span>).getElementsByTagName(<span class="string">"img"</span>);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p> 缺陷是充斥大量测试代码，且并不总是存在另一种方式能实现某个给定功能的效果。</p>
</li>
</ol>
<p><strong>在这篇文章，我们主要学习的是HTMLDOM，HTML DOM 定义了所有 HTML 元素的<em>对象</em>和<em>属性</em>，以及访问它们的<em>方法</em>。</strong></p>
<h2 id="使用Document对象"><a href="#使用Document对象" class="headerlink" title="使用Document对象"></a>使用Document对象</h2><p>DOM的一个关键组成部分就是Document对象。Document对象是通往DOM功能的入口，它向你提供了当前文档的信息，以及一组可供探索、导航、搜索或操作结构与内容的功能。<br>我们通过变量document访问Document对象，它是浏览器为我们创建的关键对象之一。</p>
<h3 id="使用Document元数据"><a href="#使用Document元数据" class="headerlink" title="使用Document元数据"></a>使用Document元数据</h3><p>Document对象的用途之一是向你提供关于文档的信息。下表介绍了你可以用来获取文档元数据的属性。</p>
<p><img src="index_files/2a3d6ac2-be28-4a8c-993d-53638e53871f.jpg" alt=""></p>
<ul>
<li><p>获取文档信息</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"&lt;pre&gt;"</span>);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"characterSet:"</span>+<span class="built_in">document</span>.characterSet); <span class="comment">//只读</span></div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"charset:"</span>+<span class="built_in">document</span>.charset); <span class="comment">//读取</span></div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"compatMode:"</span>+<span class="built_in">document</span>.compatMode); </div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"defaultCharset:"</span>+<span class="built_in">document</span>.defaultCharset);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"domain:"</span>+<span class="built_in">document</span>.domain);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"referrer:"</span>+<span class="built_in">document</span>.referrer);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"lastModified:"</span>+<span class="built_in">document</span>.lastModified);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"cookie:"</span>+<span class="built_in">document</span>.cookie);</div><div class="line">            <span class="built_in">document</span>.writeln(<span class="string">"&lt;/pre&gt;"</span>);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  理解怪异模式<br>  compatMode属性告诉你浏览器是如何处理文档内容的。现如今存在着大量的非标准HTML，浏览器则试图显示这类网页，哪怕它们并不遵循HTML规范。一些这样的内容依赖于浏览器的特殊功能，而这些功能来源于浏览器依靠自身特点（而非遵循标准）进行竞争的年代。compatMode属性会返回两个值中的一个。</p>
<p>  | 值 | 说明 |<br>  | — | — |<br>  | CSS1Compat | 此文档遵循某个有效的HTML规范（不必是HTML5规范） |<br>  | BackCompat | 此文档含有非标准功能，已触发怪异模式 |</p>
</li>
<li><p>使用Location对象<br>  document.location属性返回一个Location对象，这个对象给你提供了细粒度的文档地址信息，也允许你导航到其他文档上。</p>
<p>  <img src="index_files/44115d5b-91d5-446a-a0b2-7a4f02d79d20.jpg" alt=""></p>
<p>  使用Location对象导航到其他地方</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"bananaBtn"</span>&gt;</span>链接到香蕉<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"testAssign"</span>&gt;</span>assign页面跳转<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"testReplace"</span>&gt;</span>replace页面跳转<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"banana"</span> <span class="attr">style</span>=<span class="string">"position: relative;top: 2000px;"</span>&gt;</span></div><div class="line">        此处应该有香蕉</div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="comment">//等价于&lt;a href="#banana"&gt;链接到香蕉&lt;/a&gt;</span></div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"bananaBtn"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="built_in">document</span>.location.hash = <span class="string">"banana"</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"testAssign"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="built_in">document</span>.location.assign(<span class="string">"https://www.google.com.hk"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"testReplace"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="comment">//使用replace在浏览历史找不到，无法返回上一个页面</span></div><div class="line">                <span class="built_in">document</span>.location.replace(<span class="string">"https://www.google.com.hk"</span>);</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>读取和写入cookie<br>  cookie属性让你可以读取、添加和更新文档所关联的cookie。当读取cookie属性的值时，会得到与文档相关联的所有cookie。cookie的形式为name=value，如果存在多个cookie，以分号相隔。操作cookie的方法是直接给cookie属性赋值，如果要添加的cookie在现有cookie集合中没有，则添加的cookie新增到现有的cookie集合，否则会更新现有cookie。下面是完整示例：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">    &lt;!DOCTYPE html&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"cookieData"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"addCookie"</span>&gt;</span>添加cookie<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"updateCookie"</span>&gt;</span>更新最后一个cookie<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> counter = <span class="number">0</span>;</div><div class="line">            readCookie();</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"addCookie"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                counter++;</div><div class="line">                <span class="built_in">document</span>.cookie = <span class="string">"cookie_"</span>+counter+<span class="string">"=value_"</span>+counter;</div><div class="line">                readCookie();</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"updateCookie"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="built_in">document</span>.cookie = <span class="string">"cookie_"</span>+counter+<span class="string">"=update_"</span>+counter;</div><div class="line">                readCookie();</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">readCookie</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="built_in">document</span>.getElementById(<span class="string">"cookieData"</span>).innerHTML = <span class="built_in">document</span>.cookie;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  虽然添加cookie的默认形式是name=value，但可以额外应用一些数据改变cookie的处理方式</p>
<p>  <img src="index_files/ce20ba02-a003-4b34-b9ae-660cd08030e0.jpg" alt=""></p>
</li>
<li><p>理解就绪状态<br>  document.readyState属性向你提供了加载和解析HTML文档过程中当前处于哪个阶段的信息。了解浏览器加载和处理HTML到了哪个阶段可能会很有用。readyState属性会返回三个不同的值。</p>
<p>  | 值 | 说明 |<br>  | — | — |<br>  | loading | 浏览器正在加载和处理此文档 |<br>  | interactive | 文档已被解析，但浏览器还在加载其中链接的资源（图像媒体文件等） |<br>  | complete | 文档解析完，资源也加载完 |</p>
<p>  这个属性和readystatechange事件结合使用时用处最大，该事件会在每次readyState属性的值发生变化时触发。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">    &lt;!DOCTYPE html&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="built_in">document</span>.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(<span class="built_in">document</span>.readyState);</div><div class="line">                <span class="keyword">if</span>(<span class="built_in">document</span>.readyState==<span class="string">"interactive"</span>)&#123;</div><div class="line">                    <span class="built_in">document</span>.getElementById(<span class="string">"pressme"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                        <span class="built_in">document</span>.getElementById(<span class="string">"results"</span>).innerHTML = <span class="string">"Button Pressed"</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"pressme"</span>&gt;</span>Press me<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">pre</span> <span class="attr">id</span>=<span class="string">"results"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">pre</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>获取DOM的实现情况<br>document.implementation属性提供了浏览器对DOM功能的实现信息，这个属性返回一个DOMImplementation对象，对象有一个hasFeature方法，这个方法可以用来判断哪些DOM功能已实现。</p>
</li>
</ul>
<h3 id="获取HTML元素对象"><a href="#获取HTML元素对象" class="headerlink" title="获取HTML元素对象"></a>获取HTML元素对象</h3><ul>
<li><p>使用属性获取元素对象<br>  Document对象提供了一组属性，它们会返回文档中特定元素或元素类型的对象。</p>
<p>  <img src="index_files/c8bf8a8a-63d9-46f3-884a-763dbb18d481.jpg" alt=""></p>
<p>  使用namedItem方法<br>  namedItem方法会返回集合里带有指定id或name属性值的项目。例如：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">//返回id或name属性值为apple的图片的src。优先返回匹配id属性的元素，如果没有匹配id的元素，则返回第一个匹配name属性的元素，如果还是没有，返回null</span></div><div class="line">    <span class="built_in">document</span>.images.namedItem(<span class="string">"apple"</span>).src;</div></pre></td></tr></table></figure>
</li>
<li><p>搜索元素<br>  Document对象定义了很多方法，可以用他们搜索文档里的元素。</p>
<p>  | 属性 | 说明 | 返回 |<br>  | — | — | — |<br>  | getElementById(id) | 返回带有指定id值的元素 | HTMLElement |<br>  | getElementsByClassName(class) | 返回带有指定class类的元素 | 数组 |<br>  | getElementsByName(name) | 返回带有指定name值的元素 | 数组 |<br>  | getElementsByTagName(tag) | 返回指定类型的元素 | 数组 |<br>  | querySelector(selector) | 返回匹配指定CSS选择器的第一个元素 | HTMLElement |<br>  | querySelectorAll(selector) | 返回匹配指定CSS选择器的所有元素 | 数组 |</p>
</li>
<li><p>合并进行链式搜索<br>  DOM的一个使用功能是几乎所有的Document对象实现的搜索方法同时也能被HTMLElement对象实现（一个例外），这让你可以合并进行链式搜索。唯一的例外是getElementById方法，只有Document对象才能使用它。例如：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"tblock"</span>).getElementsByTagName(<span class="string">"span"</span>);</div><div class="line">    <span class="comment">//等价于</span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"tblock"</span>).querySelectorAll(<span class="string">"span"</span>);</div><div class="line">    <span class="comment">//等价于</span></div><div class="line">    <span class="built_in">document</span>.querySelectorAll(<span class="string">"#tblock &gt; span"</span>);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="在DOM树里导航"><a href="#在DOM树里导航" class="headerlink" title="在DOM树里导航"></a>在DOM树里导航</h3><p>另一种搜索元素的方法是将DOM视为一棵树，然后在它的层级结构里导航。所有的DOM对象都支持一组属性和方法来让我们做到这一点。</p>
<p><img src="index_files/1c7d1dc8-2ea0-4e46-8835-2cde3613fc34.jpg" alt=""></p>
<h2 id="使用Window对象"><a href="#使用Window对象" class="headerlink" title="使用Window对象"></a>使用Window对象</h2><h3 id="获取window对象"><a href="#获取window对象" class="headerlink" title="获取window对象"></a>获取window对象</h3><p>可以用两种方式获得window对象。正规的HTML5方式是在Document对象上使用defaultView属性。另一种是使用所有浏览器都支持的全局变量window。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.outerWidth);</div><div class="line"><span class="comment">//等价于</span></div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">document</span>.defaultView.outerHeight);</div></pre></td></tr></table></figure></p>
<h3 id="获取窗口信息"><a href="#获取窗口信息" class="headerlink" title="获取窗口信息"></a>获取窗口信息</h3><p>顾名思义，Window对象的基本功能涉及到当前文档所显示的窗口。下表列出了这些功能的属性和方法。</p>
<p><img src="index_files/d32ac75b-3743-4788-b758-d09d56200b6d.jpg" alt=""><br><img src="index_files/7726888c-bc8a-40f0-9185-c7fe050088e2.jpg" alt=""></p>
<p>screen对象的宽高取决于屏幕大小，与浏览器窗口大小无关，window对象的宽高取决于浏览器窗口的大小。</p>
<h3 id="与窗口进行交互"><a href="#与窗口进行交互" class="headerlink" title="与窗口进行交互"></a>与窗口进行交互</h3><p>Window对象提供了一组方法，可以用它们与包含文档的窗口进行交互。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>blur()</td>
<td>让窗口失去键盘焦点</td>
<td>void</td>
</tr>
<tr>
<td>close()</td>
<td>关闭窗口</td>
<td>void</td>
</tr>
<tr>
<td>focus()</td>
<td>让窗口获得键盘焦点</td>
<td>void</td>
</tr>
<tr>
<td>print()</td>
<td>提示用户打印页面</td>
<td>void</td>
</tr>
<tr>
<td>scrollBy(x,y)</td>
<td>让文档相对于当前位置进行滚动</td>
<td>void</td>
</tr>
<tr>
<td>scrollTo(x,y)</td>
<td>滚动到指定的位置</td>
<td>void</td>
</tr>
<tr>
<td>stop()</td>
<td>停止加载文档</td>
<td>void</td>
</tr>
</tbody>
</table>
<p>这些方法应该谨慎使用，因为它们会让用户失去对浏览器窗口的控制。</p>
<h3 id="对用户进行提示"><a href="#对用户进行提示" class="headerlink" title="对用户进行提示"></a>对用户进行提示</h3><p>Window对象包含一组方法，能以不同的方式对用户进行提示。</p>
<p><img src="index_files/943ed4c3-746d-435b-b55f-1788c5eea0fc.jpg" alt=""></p>
<p>下面是例子：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE html&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> confirmd = <span class="built_in">window</span>.confirm(<span class="string">"哈哈哈"</span>);</div><div class="line">            <span class="built_in">console</span>.log(confirmd); <span class="comment">//true or false</span></div><div class="line">            <span class="keyword">var</span> responseText = <span class="built_in">window</span>.prompt(<span class="string">"Enter a word"</span>,<span class="string">"hello"</span>);</div><div class="line">            <span class="built_in">console</span>.log(responseText);  <span class="comment">//hello是默认值</span></div><div class="line">            <span class="comment">//window.showModalDialog("animation.html"); //已不支持</span></div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="获取基本信息"><a href="#获取基本信息" class="headerlink" title="获取基本信息"></a>获取基本信息</h3><p>Window对象让你能访问某些返回基本信息的对象。下表是返回的对象：</p>
<p><img src="index_files/bea626a9-00bd-435d-8ae3-980365be7e8a.jpg" alt=""></p>
<p>Document对象和Location对象之前已经讲过，下面介绍History对象。</p>
<h3 id="使用浏览器历史"><a href="#使用浏览器历史" class="headerlink" title="使用浏览器历史"></a>使用浏览器历史</h3><p>window.history属性返回一个History对象，你可以用它对浏览器历史进行一些基本的操作。</p>
<p><img src="index_files/003ae2a2-7539-4629-b109-234a6c42ee1e.jpg" alt=""></p>
<ul>
<li>在浏览历史中导航<br>back、forward和go这三个方法告诉浏览器该导航到浏览历史中的哪个URL上。back/forward方法的效果和浏览器的后退/前进按钮是一致的。go方法会导航至当前文档的某个浏览历史位置。正值表示浏览器应该在浏览历史中前进，负值则表示后退。</li>
<li><p>在浏览历史里插入条目<br>  History.pushState方法允许我们给浏览器历史添加一个URL，但有一些约束条件。URL的服务器名称和端口号必须与当前文档的相同。例：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    <span class="built_in">window</span>.history.push(<span class="string">""</span>,<span class="string">""</span>,<span class="string">"?#"</span>+event.target.id);</div></pre></td></tr></table></figure>
<p>  当向浏览器历史添加条目时，不需要局限于当前页面，可以指定任何URL，只需要来源和当前文档相同即可。例如：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">    <span class="built_in">window</span>.history.push(<span class="string">""</span>,<span class="string">""</span>,<span class="string">"otherpage.html?#"</span>+event.target.id);</div></pre></td></tr></table></figure>
<p>  添加条目之后，导航框显示的是另一个文档的URL，但文档本身没有变化。如果用户导航至别的文档，然后点击后退时，浏览器会自行选择显示原来的文档还是指定的文档（otherpage.html）</p>
</li>
</ul>
<h3 id="使用跨文档消息传递（重要）"><a href="#使用跨文档消息传递（重要）" class="headerlink" title="使用跨文档消息传递（重要）"></a>使用跨文档消息传递（重要）</h3><p>Window对象还为另一种名为“跨文档消息传递”的HTML5新功能提供了入口。通常，不同来源（协议不同或主机不同或端口不同）的脚本是不允许进行通信的。但HTML5通过Window里的方法为这类通信提供了一种规范。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>postMessage(msg,origin)</td>
<td>给另一个文档发送指定的消息</td>
<td>void</td>
</tr>
</tbody>
</table>
<p>下面是详细例子：</p>
<ul>
<li><p>postMessage.html文档</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"satus"</span>&gt;</span>Ready<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"send"</span>&gt;</span>Send message<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!--不同源文档通信,这里端口号不同,本文档使用8030端口--&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">"main"</span> <span class="attr">name</span>=<span class="string">"main"</span> <span class="attr">src</span>=<span class="string">"http://127.0.0.1:8888/otherpage.html"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"send"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="comment">//window对象的postMessage方法,第一个参数是数据,第二个参数是origin</span></div><div class="line">                <span class="built_in">window</span>[<span class="string">"main"</span>].postMessage(<span class="string">"I like apples"</span>,<span class="string">"http://127.0.0.1:8888"</span>);</div><div class="line">                <span class="built_in">document</span>.getElementById(<span class="string">"satus"</span>).innerHTML = <span class="string">"Message sent"</span>;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>otherpage.html文档</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">"message"</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="built_in">window</span>.addEventListener(<span class="string">"message"</span>,receiveMessage,<span class="literal">false</span>);</div><div class="line">            <span class="comment">//接收消息</span></div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">receiveMessage</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="comment">//e.orgin表示消息来源</span></div><div class="line">                <span class="keyword">if</span>(e.origin==<span class="string">"http://127.0.0.1:8030"</span>)&#123;</div><div class="line">                    <span class="comment">//e.data表示接收的数据</span></div><div class="line">                    displayMessage(e.data);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    displayMessage(<span class="string">"Message discarded!"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="comment">//显示消息</span></div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">displayMessage</span>(<span class="params">msg</span>)</span>&#123;</div><div class="line">                <span class="built_in">document</span>.getElementById(<span class="string">"message"</span>).innerHTML = msg;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>注意上例中，window[“main”]可以获取到name属性为main的iframe的window对象。此外，Window对象还提供了其他寻找嵌入文档所需的支持，见下表：</p>
<p><img src="index_files/e7a361ef-86e9-43c1-b0b8-28e839998c72.jpg" alt=""></p>
<p><code>message</code>事件返回的MessageEvent对象的属性：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>data</td>
<td>返回别的脚本发送的消息</td>
<td>对象</td>
</tr>
<tr>
<td>origin</td>
<td>返回发送消息脚本的来源</td>
<td>字符串</td>
</tr>
<tr>
<td>source</td>
<td>返回发送消息脚本所关联的窗口</td>
<td>Window</td>
</tr>
</tbody>
</table>
<h3 id="使用计时器"><a href="#使用计时器" class="headerlink" title="使用计时器"></a>使用计时器</h3><p>Window对象提供了一个有用功能是可以设置一次性和循环的计时器。这些计时器被用于在预设的时间段后执行某个函数。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>clearInterval(id)</td>
<td>撤销某个时间间隔计时器</td>
<td>void</td>
</tr>
<tr>
<td>clearTimeout(id)</td>
<td>撤销某个超时计时器</td>
<td>void</td>
</tr>
<tr>
<td>setInterval(function,time)</td>
<td>创建一个计时器，每隔time毫秒循环调用指定函数</td>
<td>计时器的id</td>
</tr>
<tr>
<td>setTimeout(function,time)</td>
<td>创建一个计时器，等待time毫秒之后调用指定的函数</td>
<td>计时器的id</td>
</tr>
</tbody>
</table>
<h2 id="使用DOM元素"><a href="#使用DOM元素" class="headerlink" title="使用DOM元素"></a>使用DOM元素</h2><h3 id="使用对象元素"><a href="#使用对象元素" class="headerlink" title="使用对象元素"></a>使用对象元素</h3><p>HTMLElement对象提供了一组属性，你可以用它们来读取和修改被代表元素的数据。</p>
<p><img src="index_files/5fbc7630-3d65-4785-9f68-d8873fcbfaaf.jpg" alt=""></p>
<p><strong>注意：诸如element.id之类获取元素属性的方法是HTML-DOM的内容，也就是说，这种写法只在HTML文档中能正常使用</strong></p>
<ul>
<li><p>使用类<br>  有两种方式处理某个元素所属的类。第一种方式是使用className属性。它会返回一个字符串形式的类列表。通过改变这个字符串的值，你就能添加或移除类。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">    <span class="comment">//在原有基础上添加一个newClass的类</span></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"textBlock"</span>).className += <span class="string">" newClass"</span>;</div></pre></td></tr></table></figure>
<p>  当想要快速给某个元素添加类时，使用className属性很方便，但如果想移除一个类时，用classList属性更方便，它返回一个DOMTokenList对象，这个对象定义了一些有用的属性和方法来管理类列表。</p>
<p>  <img src="index_files/5f47e41e-49c4-4f92-b439-8bc2adbf859e.jpg" alt=""></p>
</li>
<li><p>使用元素属性<br>  HTMLElement对象既有一些属性来对应最重要的HTML全局属性，又支持对单个元素的任意属性进行读取和设置。</p>
<p>  <img src="index_files/2bbc15b4-4a5b-41a3-803b-c5323dd4f6b5.jpg" alt=""></p>
<ol>
<li>使用以data-开头的自定义属性<br>使用HTMLElement对象的dataset属性返回的是一个由所有data-开头的属性值组成的数组，其索引根据的是名称的自定义部分。如果要获取elem元素的data-fruit属性的值，可以使用<code>elem.dataset[&quot;fruit&quot;]</code></li>
<li>使用所有属性<br>可以通过attributes属性获取一个包含元素所有属性的集合。它会返回一个由Attr对象组成的数组。Attr对象包含name属性和value属性，分别对应属性名和属性值。下面是例子：<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">    &lt;!DOCTYPE html&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> attrs = <span class="built_in">document</span>.getElementById(<span class="string">"text"</span>).attributes;</div><div class="line">            <span class="built_in">console</span>.log(attrs);</div><div class="line">            <span class="built_in">console</span>.log(attrs[<span class="string">"id"</span>].name,attrs[<span class="string">"id"</span>].value);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<h3 id="使用Text对象"><a href="#使用Text对象" class="headerlink" title="使用Text对象"></a>使用Text对象</h3><p>元素的文本内容是由Text对象代表的。它在文档模型里表现为元素的子对象。当文本中包含元素时，如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">            测试Text对象及文本中的<span class="tag">&lt;<span class="name">b</span>&gt;</span>元素<span class="tag">&lt;/<span class="name">b</span>&gt;</span>.Text对象</div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pElement = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"p"</span>)[<span class="number">0</span>];</div><div class="line">            <span class="comment">//3个子节点,包含两个文本节点,一个元素节点</span></div><div class="line">            <span class="built_in">console</span>.log(pElement.childNodes.length);</div><div class="line">            <span class="comment">//打印"测试Text对象及文本中的",注意,包含空格和换行符。</span></div><div class="line">            <span class="built_in">console</span>.log(pElement.firstChild.nodeValue);</div><div class="line">            <span class="comment">//打印".Text对象",注意,包含空格和换行符。</span></div><div class="line">            <span class="built_in">console</span>.log(pElement.lastChild.nodeValue);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; pElement.childNodes.length ; i++)&#123;</div><div class="line">                <span class="comment">//元素节点的nodeType是1</span></div><div class="line">                <span class="keyword">if</span>(pElement.childNodes[i].nodeType==<span class="number">1</span>)&#123;</div><div class="line">                    <span class="comment">//打印"元素"</span></div><div class="line">                    <span class="built_in">console</span>.log(pElement.childNodes[i].firstChild.nodeValue);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>DOM模型如下图：</p>
<p><img src="index_files/04215fe1-e392-4048-89ea-a012c1e88f6d.jpg" alt=""></p>
<p>Text对象包含了一些操作对象的方法或属性：</p>
<p><img src="index_files/f26d0172-46dc-49d9-afe8-b382e67ff534.jpg" alt=""></p>
<h3 id="修改模型"><a href="#修改模型" class="headerlink" title="修改模型"></a>修改模型</h3><p>在前面的章节中，我们之所以能修改元素的属性和文本，是因为文档自身和DOM之间有着实时的连接。一旦你对DOM做了改动，浏览器就会让文档发生相应的变化。你也可以利用这一点改变DOM的层级结构，因为连接是实时的，你对DOM层级结构的修改会立即反映到浏览器中。<br>下面介绍了可用于修改DOM层级结构的属性和方法：</p>
<table>
<thead>
<tr>
<th>成员</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>appendChild(HTMLElement)</td>
<td>将指定元素添加为当前元素的子元素</td>
<td>添加的HTMLElement</td>
</tr>
<tr>
<td>cloneNode(boolean)</td>
<td>复制一个元素，参数指定是否复制子元素</td>
<td>复制出来的HTMLElement</td>
</tr>
<tr>
<td>innerHTML</td>
<td>获取或设置元素的内容</td>
<td>内容字符串</td>
</tr>
<tr>
<td>insertAdjacentHTML(pos,HTML片段)</td>
<td>相对于元素插入HTML片段</td>
<td>void</td>
</tr>
<tr>
<td>insertBefore(newElem,childElem)</td>
<td>在第二个子元素之前插入第一个元素</td>
<td>被插入的HTMLElement</td>
</tr>
<tr>
<td>isEqualNode(HTMLElement)</td>
<td>判断参数指定的元素是否与当前元素相同</td>
<td>布尔值</td>
</tr>
<tr>
<td>isSameNode(HTMLElement)</td>
<td>判断指定元素是否就是当前元素</td>
<td>布尔值</td>
</tr>
<tr>
<td>outerHTML</td>
<td>获取或设置元素的HTML和内容</td>
<td>元素及其内容字符串</td>
</tr>
<tr>
<td>removeChild(HTMLElement)</td>
<td>从当前元素上移除指定的子元素</td>
<td>返回移除的HTMLElement</td>
</tr>
<tr>
<td>replaceChild(newElem,oldElem)</td>
<td>替换当前元素的某个子元素</td>
<td>返回被替换的HTMLElement</td>
</tr>
</tbody>
</table>
<p>这些属性和方法对所有的元素对象都是适用的，另外，<strong>document对象</strong>定义了两个用于创建新元素的方法：</p>
<table>
<thead>
<tr>
<th>成员</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>createElement(tag)</td>
<td>创建一个属于指定标签类型的HTMLElement对象</td>
<td>HTMLElement</td>
</tr>
<tr>
<td>createTextNode(text)</td>
<td>创建一个带有指定内容的新的Text对象</td>
<td>Text</td>
</tr>
</tbody>
</table>
<ul>
<li><p>创建和删除元素<br>  你需要通过document对象创建新的元素，然后找到一个现存的HTMLElement，通过之前介绍的方法来插入它们。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">    &lt;!DOCTYPE html&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">table</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>banana<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>yellow<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>apple<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">                    <span class="tag">&lt;<span class="name">td</span>&gt;</span>red/green<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">                <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"add"</span>&gt;</span>add<span class="tag">&lt;/<span class="name">button</span>&gt;</span><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"remove"</span>&gt;</span>remove<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> tbody = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"tbody"</span>)[<span class="number">0</span>];</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"add"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="keyword">var</span> newTr = <span class="built_in">document</span>.createElement(<span class="string">"tr"</span>);</div><div class="line">                newTr.setAttribute(<span class="string">"id"</span>,<span class="string">"newTr"</span>);</div><div class="line">                <span class="comment">//appendChild方法返回的是被插入的元素</span></div><div class="line">                newTr.appendChild(<span class="built_in">document</span>.createElement(<span class="string">"td"</span>))</div><div class="line">                .appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">"orange"</span>));</div><div class="line">                newTr.appendChild(<span class="built_in">document</span>.createElement(<span class="string">"td"</span>))</div><div class="line">                .appendChild(<span class="built_in">document</span>.createTextNode(<span class="string">"orange"</span>));</div><div class="line">                tbody.appendChild(newTr);</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"remove"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                tbody.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">"newTr"</span>));</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>复制元素<br>  可以使用cloneNode方法来复制现有元素，cloneNode方法的布尔值参数指定了是否应该同时复制该元素的所有子元素，方法返回复制出来的元素。</p>
</li>
<li><p>移动元素<br>  要把元素从文档的一处移动到另一处，需要做的仅仅是把待移动的元素关联到新的父元素上，而不需要让该元素脱离它的初始位置。例如，把一张表格id为apple的行移动到另一张id为others的表格：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">    <span class="keyword">var</span> elem = <span class="built_in">document</span>.getElementById(<span class="string">"apple"</span>);</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"others"</span>).appendChild(elem);</div></pre></td></tr></table></figure>
</li>
<li><p>比较元素对象<br>  可以通过两种方式比较元素对象。第一种方式是比较他们是否是同一个元素，使用isSameNode方法。另一种方式是使用isEqualNode方法测试元素对象是否相同。如果多个元素具有相同的类型，带有相同的属性，其子元素也相同并且排列顺序一致，那么他们就是相同元素。</p>
</li>
<li><p>使用HTML片段<br>  innerHTML属性，outerHTML属性和insertAdjacentHTML方法都是便利的语法捷径，它们让你能够使用HTML片段，从而不再需要创建元素和文本对象的详细层级结构。</p>
<ol>
<li>innerHTML和outerHTML<br>outerHTML属性返回一个字符串，它包含定义这个元素及其所有子元素的HTML。innerHTML属性只返回子元素的HTML。也可以通过设置outerHTML和innerHTML属性改变文档结构。</li>
<li><p>使用insertAdjacentHTML插入HTML片段（重要）<br>innerHTML和outerHTML属性对于替换现有的元素而言是很有用的，但是如果想要用HTML片段来插入新元素，就必须使用insertAdjacentHTML方法。方法接受两个参数，第一个参数是片段应该插入到相当当前元素哪个位置，第二个参数是要插入的片段。<br>第一个参数取值如下：</p>
<p> | 值 | 说明 |<br> | — | — |<br> | afterbegin | 将片段作为当前元素的第一个子元素插入 |<br> | afterend | 将片段插入当前元素之后 |<br> | beforebegin | 将片段插入当前元素之前 |<br> | beforeend | 将片段作为当前元素最后一个子元素插入 |</p>
</li>
</ol>
</li>
<li><p>向文本块插入元素<br>  修改模型的另一种重要方式是向由Text对象代表的文本块添加元素。下面是一个复杂的例子：</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">    &lt;!DOCTYPE html&gt;</div><div class="line">    <span class="xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"textblock"</span>&gt;</span>There are lots of different kinds of fruits.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"insert"</span>&gt;</span>Insert Element<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="comment">//将一个元素插入文本块</span></div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"insert"</span>).onclick=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="keyword">var</span> textBlock = <span class="built_in">document</span>.getElementById(<span class="string">"textblock"</span>);</div><div class="line">                <span class="comment">//返回lots of different kinds of fruits.</span></div><div class="line">                textBlock.firstChild.splitText(<span class="number">10</span>);</div><div class="line">                <span class="comment">//textBlock.childNodes[1]即lots of different kinds of fruits.</span></div><div class="line">                <span class="comment">//textBlock.childNodes[1].splitText(4)返回 of different kinds of fruits.</span></div><div class="line">                <span class="comment">//newText即lots</span></div><div class="line">                <span class="keyword">var</span> newText=textBlock.childNodes[<span class="number">1</span>].splitText(<span class="number">4</span>).previousSibling;</div><div class="line">                <span class="built_in">console</span>.log(textBlock,newText);</div><div class="line">                <span class="comment">//下面这句相当于创建了一个b元素并插入到lots节点之前，然后把lots节点移动到b元素内。</span></div><div class="line">                textBlock.insertBefore(<span class="built_in">document</span>.createElement(<span class="string">"b"</span>),newText).appendChild(newText);</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="为DOM元素设置样式"><a href="#为DOM元素设置样式" class="headerlink" title="为DOM元素设置样式"></a>为DOM元素设置样式</h2><p>这一章，展示如何使用DOM操作文档中的CSS样式，包括显示定义的，也包括浏览器用来实际显示元素的计算样式（computed style)。但不少DOM处理样式规范没被实现，这里只把焦点放在浏览器实际使用的那些上，并非本章所有内容都能在各种主流浏览器上运行。</p>
<h3 id="使用样式表"><a href="#使用样式表" class="headerlink" title="使用样式表"></a>使用样式表</h3><p>可以通过document.styleSheets属性访问文档中可用的CSS样式表，它会返回一组对象集合，这些对象代表了与文档关联的各个样式表。每个样式表（包括使用style元素定义和使用link元素定义的）都由一个CSSStyleSheet对象代表，它提供了一组属性和方法来操作文档里的样式表(部分属性没列举)：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>disabled</td>
<td>获取或设置样式表的禁用状态</td>
<td>void</td>
</tr>
<tr>
<td>href</td>
<td>返回链接样式表的href,如果是style元素，返回null</td>
<td>字符串</td>
</tr>
<tr>
<td>media</td>
<td>返回应用到样式表上的媒介限制集合</td>
<td>MediaList</td>
</tr>
<tr>
<td>ownerNode</td>
<td>返回样式所定义的元素</td>
<td>HTMLElement（style或link）</td>
</tr>
<tr>
<td>title</td>
<td>返回title属性的值</td>
<td>字符串</td>
</tr>
<tr>
<td>type</td>
<td>返回type属性的值</td>
<td>字符串</td>
</tr>
</tbody>
</table>
<ul>
<li>获得样式表的基本信息<br>  使用CSSStyleSheet对象即可获取相应样式表的基本信息</li>
<li><p>使用媒介限制<br>  当定义样式表时，可以使用media属性来限制样式应用的场合。可以使用CSSStyleSheet.media属性访问这些限制，它会返回一个MediaList对象。下面是MediaList对象的方法和属性。</p>
<p>  | 成员 | 说明 | 返回 |<br>  | — | — | — |<br>  | appendMedium(medium) | 添加一个新媒介到列表中 | void |<br>  | deleteMedium(medium) | 从列表中移除一个媒介 | void |<br>  | item(pos) | 返回指定索引的媒介 | 字符串 |<br>  | length | 返回媒介的数量 | 数值 |<br>  | mediaText | 返回media属性的文本值 | 字符串 |</p>
</li>
<li><p>禁用样式表<br>  CSSStyleSheet.disabled属性可用来一次性启用和禁用某个样式表里的所有样式。</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"pressme"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">     <span class="built_in">document</span>.stylesheet[<span class="number">0</span>].disabled = !<span class="built_in">document</span>.stylesheet[<span class="number">0</span>].disabled;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>CSSRuleList对象的成员<br>  CSSStyleSheet.cssRules属性会返回一个CSSRuleList对象，它允许你访问样式表里的各种样式。下面是CSSRuleList对象的成员：</p>
<p>  | 成员 | 说明 | 返回 |<br>  | — | — | — |<br>  | item(pos) | 返回指定索引的CSS样式（花括号包裹的即为一个CSSStyleRule） | CSSStyleRule |<br>  | length | 返回样式表里的样式数量 | 数值 |</p>
<p>  样式表里每一种样式都由一个CSSStyleRule对象代表，下面是CSSStyleRule对象的成员。</p>
<p>  | 成员 | 说明 | 返回 |<br>  | — | — | — |<br>  | cssText | 获取或设置样式的文本 | 字符串 |<br>  | parentStyleSheet | 获取此样式所属的样式表 | CSSStyleSheet |<br>  | selectorText | 获取或设置样式的选择器文本 | 字符串 |<br>  | style | 获取一个代表具体样式属性的对象 | CSSStyleDeclaration |</p>
<p>  下面是综合例子：</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"></span></div><div class="line">            <span class="selector-id">#test</span>&#123;</div><div class="line">                <span class="attribute">color</span>: black;</div><div class="line">                <span class="attribute">background-color</span>: <span class="number">#ccc</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="selector-id">#test</span> <span class="selector-tag">b</span>&#123;</div><div class="line">                <span class="attribute">color</span>: red;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">style</span>=<span class="string">"font-weight: 400;"</span>&gt;</span></div><div class="line">            哈哈哈哈<span class="tag">&lt;<span class="name">b</span>&gt;</span>嘿嘿<span class="tag">&lt;/<span class="name">b</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> CSSRule1 = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules.item(<span class="number">0</span>);</div><div class="line">            <span class="keyword">var</span> CSSRule2 = <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules.item(<span class="number">1</span>);</div><div class="line">            <span class="comment">//#test &#123; color: black; background-color: rgb(204, 204, 204); &#125;</span></div><div class="line">            <span class="built_in">console</span>.log(CSSRule1.cssText);</div><div class="line">            <span class="comment">//#test b &#123; color: red; &#125;</span></div><div class="line">            <span class="built_in">console</span>.log(CSSRule2.cssText);</div><div class="line">            <span class="comment">//CSSRule1.style返回一个CSSStyleDeclaration对象</span></div><div class="line">            <span class="built_in">console</span>.log(CSSRule1.style.backgroundColor);</div><div class="line">            <span class="keyword">var</span> pObj = <span class="built_in">document</span>.getElementById(<span class="string">"test"</span>);</div><div class="line">            <span class="comment">//HTMLElement.style返回一个CSSStyleDeclaration对象，表示的是用style属性声明的样式</span></div><div class="line">            <span class="built_in">console</span>.log(pObj.style.fontWeight);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="使用元素样式"><a href="#使用元素样式" class="headerlink" title="使用元素样式"></a>使用元素样式</h3><p>元素的style属性返回一个CSSStyleDeclaration对象，它表示通过元素style属性定义的样式。我们可以通过读取或设置cssText属性来读取或设置元素的样式，但这并不是一个很好的方法，下一节将会学习更健壮的方法。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"textblock"</span> <span class="attr">style</span>=<span class="string">"color:red;font-size:22px;"</span>&gt;</span>哈哈哈哈哈<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="comment">//表示通过元素style属性定义的样式</span></div><div class="line">            <span class="keyword">var</span> styleDeclaration = <span class="built_in">document</span>.getElementById(<span class="string">"textblock"</span>).style;</div><div class="line">            <span class="built_in">console</span>.log(styleDeclaration.cssText);</div><div class="line">            <span class="comment">//这样设置会覆盖原有所有样式</span></div><div class="line">            styleDeclaration.cssText = <span class="string">"color:green;border:1px solid #ccc;"</span>;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="使用CSSStyleDeclaration对象"><a href="#使用CSSStyleDeclaration对象" class="headerlink" title="使用CSSStyleDeclaration对象"></a>使用CSSStyleDeclaration对象</h3><p>你处理的是样式表还是某个元素的style属性并不重要。要通过DOM完全控制CSS，必须使用CSSStyleDeclaration对象。下面是这个重要对象的成员：</p>
<table>
<thead>
<tr>
<th>成员</th>
<th>说明</th>
<th>返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>cssText</td>
<td>获取或设置样式的文本</td>
<td>字符串</td>
</tr>
<tr>
<td>getPropertyCSSValue(name)</td>
<td>获取指定的属性</td>
<td>CSSPrimitiveValue</td>
</tr>
<tr>
<td>getPropertyPriority(name)</td>
<td>获取指定属性的优先级</td>
<td>字符串</td>
</tr>
<tr>
<td>getPropertyValue(name)</td>
<td>获取字符串形式的指定值</td>
<td>字符串</td>
</tr>
<tr>
<td>item(pos)</td>
<td>获取指定位置的项目</td>
<td>字符串</td>
</tr>
<tr>
<td>parentRule</td>
<td>如果存在样式规则就获取它</td>
<td>CSSStyleRule</td>
</tr>
<tr>
<td>removeProperty(name)</td>
<td>移除指定的属性</td>
<td>字符串</td>
</tr>
<tr>
<td>setProperty(name,value,priority)</td>
<td>设置指定属性的值和优先级</td>
<td>void</td>
</tr>
<tr>
<td><code>&lt;style&gt;</code></td>
<td>获取或设置指定CSS属性的便捷属性</td>
<td>字符串</td>
</tr>
</tbody>
</table>
<ul>
<li><p>使用便捷属性</p>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">    <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules.item(<span class="number">1</span>).style.color = <span class="string">"#f00"</span>;</div><div class="line">    <span class="built_in">document</span>.styleSheets[<span class="number">0</span>].cssRules.item(<span class="number">1</span>).style.backgroundColor = <span class="string">"#ccc"</span>;</div></pre></td></tr></table></figure>
<p>  color、border等没有连接符的CSS属性对应的便捷属性就是本身。padding-top、background-color等带连接符的CSS属性对应的便捷属性即使用驼峰式命名之后的CSS属性。</p>
</li>
<li><p>使用常规属性<br>  如果明确知道需要处理的CSS属性名称，而且存在相应的便捷属性，那么使用便捷属性是件很简单的事。如果需要以程序方式探索CSS属性或者需要获取/设置某个没有对应便捷属性的CSS属性，那么CSSStyleDeclaration对象的其他成员可能会派上用场。下面是综合例子：</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">style</span>=<span class="string">"font-weight: 400;padding: 4px !important;"</span>&gt;</span></div><div class="line">            哈哈哈哈<span class="tag">&lt;<span class="name">b</span>&gt;</span>嘿嘿<span class="tag">&lt;/<span class="name">b</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pObjCSS = <span class="built_in">document</span>.getElementById(<span class="string">"test"</span>).style;</div><div class="line">            <span class="comment">//使用DOM操作便捷CSS属性</span></div><div class="line">            <span class="built_in">console</span>.log(pObjCSS.fontWeight);</div><div class="line">            <span class="comment">//使用DOM操作常规CSS属性</span></div><div class="line">            <span class="built_in">console</span>.log(pObjCSS.getPropertyValue(<span class="string">"font-weight"</span>));</div><div class="line">            pObjCSS.setProperty(<span class="string">"font-weight"</span>,<span class="string">"bold"</span>);</div><div class="line">            <span class="comment">//使用程序方式探索元素的CSS属性</span></div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; pObjCSS.length ; i++)&#123;</div><div class="line">                <span class="comment">//getPropertyPriority获取相应CSS属性的优先级，返回"!important"或者空字符串</span></div><div class="line">                <span class="built_in">console</span>.log(pObjCSS[i],pObjCSS.getPropertyValue(pObjCSS[i]),pObjCSS.getPropertyPriority(pObjCSS[i]));</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用细粒度的CSSDOM对象<br>  使用CSSStyleDeclaration.getPropertyCSSValue方法可以获取CSSPrimitiveValue对象，使用该对象能读取/设置更细粒度的属性，如属性值的单位、属性值的类型等。有兴趣可以自己找资料看。</p>
</li>
</ul>
<h3 id="使用计算样式"><a href="#使用计算样式" class="headerlink" title="使用计算样式"></a>使用计算样式</h3><p>之前我们都把焦点放在样式表或style属性中指定的CSS属性值上，但浏览器会从多个来源汇聚样式以计算出该用哪个值来显示某一元素。浏览器用于显示某个元素的CSS属性值集合被称为计算样式。可以通过document.defaultView.getComputedStyle（targetElem）方法获取某一元素计算样式的 CSSStyleDeclaration对象，这个对象包含了浏览器用来显示元素的所有属性细节。<br><strong>注意：获取到的计算样式都是只读属性，不能修改计算样式</strong><br>下面是例子：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="css"></span></div><div class="line">            <span class="selector-id">#test</span>&#123;</div><div class="line">                <span class="attribute">color</span>: red;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"test"</span> <span class="attr">style</span>=<span class="string">"margin: 2px;padding: 2px;"</span>&gt;</span>测试段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pTag = <span class="built_in">document</span>.getElementById(<span class="string">"test"</span>);</div><div class="line">            <span class="keyword">var</span> styleDeclaration = <span class="built_in">document</span>.defaultView.getComputedStyle(pTag);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; styleDeclaration.length ; i++)&#123;</div><div class="line">                <span class="comment">//console.log(styleDeclaration[i],styleDeclaration.getPropertyValue(styleDeclaration[i]))</span></div><div class="line">            &#125;</div><div class="line">            <span class="built_in">console</span>.log(styleDeclaration.getPropertyValue(<span class="string">"padding-top"</span>));</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="使用事件"><a href="#使用事件" class="headerlink" title="使用事件"></a>使用事件</h2><h3 id="使用简单事件处理器"><a href="#使用简单事件处理器" class="headerlink" title="使用简单事件处理器"></a>使用简单事件处理器</h3><p>元素为它们支持的事件都定义了一个事件属性。例如onmouseover事件属性对应于全局事件mouseover，后者会在用户把光标移动到元素占据的浏览器屏幕区域上方时触发。（这是一种通用模式：大多数事件都有一个对应的事件属性，其名称定义为<code>on&lt;enentname&gt;</code>）<br><strong>注意：这种简单的事件处理器是DOM 1级规范的内容，这样绑定事件只能绑定一个事件，后面绑定的会把前面绑定的事件覆盖</strong></p>
<ul>
<li><p>实现简单的内联事件处理器</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">onmouseover</span>=<span class="string">"this.style.color = '#f00';this.style.setProperty('border','1px solid #ccc');"</span> <span class="attr">onmouseout</span>=<span class="string">"this.style.removeProperty('color');this.style.removeProperty('border');"</span>&gt;</span> </div><div class="line">            测试简单的事件处理器</div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  内联事件处理器存在两个问题：其一是HTML与JavaScript混在一起，HTML代码难以阅读；其二是如果有多个具有相同行为的p元素，需要重复添加这些语句。</p>
</li>
<li>实现一个简单的事件处理函数<br>  其实就是把内联事件处理器的代码取出来封装在一个函数。</li>
</ul>
<h3 id="使用DOM和事件对象"><a href="#使用DOM和事件对象" class="headerlink" title="使用DOM和事件对象"></a>使用DOM和事件对象</h3><p>为实现事件与HTML代码分离，更优雅地定义事件处理器，需要使用DOM和JavaScript的Event对象。见下例：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pTags = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"p"</span>);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> pTags)&#123;</div><div class="line">                pTags[i].onmouseover = handleMouseOver;</div><div class="line">                pTags[i].onmouseout = handleMouseOut;</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseOver</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                e.target.style.setProperty(<span class="string">"border"</span>,<span class="string">"1px solid #ccc"</span>);</div><div class="line">                e.target.style.setProperty(<span class="string">"padding"</span>,<span class="string">"2px"</span>);</div><div class="line">                e.target.style.setProperty(<span class="string">"color"</span>,<span class="string">"red"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseOut</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                e.target.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                e.target.style.removeProperty(<span class="string">"padding"</span>);</div><div class="line">                e.target.style.removeProperty(<span class="string">"color"</span>);</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>事件触发时会有一个Event对象，这个对象提供了所发生的的事件信息。在详细讲解事件对象之前，先演示另一种使用addEventListener方法指定事件处理函数的方式，这是DOM2级定义的规范。例子如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"unbind"</span>&gt;</span>解除事件绑定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pTags = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"p"</span>);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;  pTags.length ; i++)&#123;</div><div class="line">                <span class="comment">//下面这种遍历方式遍历的是对象的属性，对于pTags而言，遍历的就是数组pTags的属性，除了索引外，数组还有length属性，pTags[length]就是2.绑定事件就会出现异常</span></div><div class="line">                <span class="comment">//for(var i in pTags)&#123;</span></div><div class="line">                pTags[i].addEventListener(<span class="string">'mouseover'</span>,handleMouseOver);</div><div class="line">                pTags[i].addEventListener(<span class="string">'mouseout'</span>,handleMouseOut);</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"unbind"</span>).addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="comment">//解除事件绑定</span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;  pTags.length ; i++)&#123;</div><div class="line">                    pTags[i].removeEventListener(<span class="string">'mouseover'</span>,handleMouseOver);</div><div class="line">                    pTags[i].removeEventListener(<span class="string">'mouseout'</span>,handleMouseOut);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseOver</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                e.target.style.setProperty(<span class="string">"border"</span>,<span class="string">"1px solid #ccc"</span>);</div><div class="line">                e.target.style.setProperty(<span class="string">"padding"</span>,<span class="string">"2px"</span>);</div><div class="line">                e.target.style.setProperty(<span class="string">"color"</span>,<span class="string">"red"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseOut</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                e.target.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                e.target.style.removeProperty(<span class="string">"padding"</span>);</div><div class="line">                e.target.style.removeProperty(<span class="string">"color"</span>);</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>addEventListener方法的优点在于它让你能够访问某些高级事件特性，后面会谈到。<br>下面来介绍Event事件对象：</p>
<p><img src="index_files/2969d766-689b-4cc2-9f13-2e8db2c57ae1.jpg" alt=""></p>
<ul>
<li><p>按类型区分事件<br>  event对象的type属性告诉你正在处理的事件是哪种类型的事件，这个值是以字符串的形式提供，比如mouseover。有了探测事件类型的能力，就可以用一个函数处理多个类型的事件，如下例：</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>测试段落2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"unbind"</span>&gt;</span>解除事件绑定<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> pTags = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"p"</span>);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;  pTags.length ; i++)&#123;</div><div class="line">                pTags[i].addEventListener(<span class="string">'mouseover'</span>,handleMouseEvent);</div><div class="line">                pTags[i].addEventListener(<span class="string">'mouseout'</span>,handleMouseEvent);</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">document</span>.getElementById(<span class="string">"unbind"</span>).addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                <span class="comment">//解除事件绑定</span></div><div class="line">                <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt;  pTags.length ; i++)&#123;</div><div class="line">                    pTags[i].removeEventListener(<span class="string">'mouseover'</span>,handleMouseEvent);</div><div class="line">                    pTags[i].removeEventListener(<span class="string">'mouseout'</span>,handleMouseEvent);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseEvent</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="keyword">if</span>(e.type==<span class="string">"mouseover"</span>)&#123;</div><div class="line">                    e.target.style.setProperty(<span class="string">"border"</span>,<span class="string">"1px solid #ccc"</span>);</div><div class="line">                    e.target.style.setProperty(<span class="string">"padding"</span>,<span class="string">"2px"</span>);</div><div class="line">                    e.target.style.setProperty(<span class="string">"color"</span>,<span class="string">"red"</span>);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    e.target.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                    e.target.style.removeProperty(<span class="string">"padding"</span>);</div><div class="line">                    e.target.style.removeProperty(<span class="string">"color"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>理解事件流<br>  一个事件的生命周期包括三个阶段：捕捉(capture)、目标（target）和冒泡（bubbling）。</p>
<ol>
<li><p>理解捕捉阶段<br>当某个事件被触发时，浏览器会找出事件涉及的元素（直接触发事件的元素），它被称为该事件的目标。浏览器会找出body元素和目标之间的所有元素并分别检查它们，看看它们是否带有事件处理器且是否要求获得其后代元素触发的事件。浏览器会先触发这些元素上的事件处理器，然后才轮到目标自身的处理器，这个阶段称为捕捉阶段。下面是具体例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"pblock"</span>&gt;</span></div><div class="line">            哈哈哈哈，我又回来了。现在来测试下<span class="tag">&lt;<span class="name">b</span> <span class="attr">id</span>=<span class="string">"btext"</span>&gt;</span>事件捕捉阶段<span class="tag">&lt;/<span class="name">b</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> btext = <span class="built_in">document</span>.getElementById(<span class="string">"btext"</span>);</div><div class="line">            <span class="keyword">var</span> pblock = <span class="built_in">document</span>.getElementById(<span class="string">"pblock"</span>);</div><div class="line">            btext.addEventListener(<span class="string">'mouseover'</span>,handleMouseEvent);</div><div class="line">            btext.addEventListener(<span class="string">'mouseout'</span>,handleMouseEvent);</div><div class="line">            <span class="comment">//第三个参数告诉浏览器我想让p元素在捕捉阶段触发p元素的事件</span></div><div class="line">            pblock.addEventListener(<span class="string">'mouseover'</span>,handleDescendantEvent,<span class="literal">true</span>);</div><div class="line">            pblock.addEventListener(<span class="string">'mouseout'</span>,handleDescendantEvent,<span class="literal">true</span>);</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleDescendantEvent</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(e.eventPhase); <span class="comment">//值为1,表示捕获阶段</span></div><div class="line">                <span class="comment">//只处理捕获阶段捕捉到的子元素的事件,不处理本身事件（目标阶段事件）,即鼠标悬停在p元素其他区域时不处理</span></div><div class="line">                <span class="keyword">if</span>(e.type==<span class="string">"mouseover"</span> &amp;&amp; e.eventPhase==Event.CAPTURING_PHASE)&#123;</div><div class="line">                    <span class="comment">//currentTarget表示的是当前被触发事件监听器的元素,target是事件涉及的元素(理解为直接触发事件的元素,该例鼠标悬停在b元素时才触发事件,所依target就表示b元素)</span></div><div class="line">                    e.target.style.border = <span class="string">'1px solid red'</span>;</div><div class="line">                    e.currentTarget.style.border = <span class="string">'1px solid black'</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(e.type==<span class="string">"mouseout"</span> &amp;&amp; e.eventPhase==Event.CAPTURING_PHASE)&#123;</div><div class="line">                    e.target.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                    e.currentTarget.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//下面这句代码可以阻止事件流向目标元素,且跳过目标和冒泡阶段,即加了下面这句代码后,b元素的mouseover和mouseout事件将不会触发</span></div><div class="line">                <span class="comment">//e.stopPropagation();</span></div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseEvent</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(e.eventPhase); <span class="comment">//值为2,表示目标阶段</span></div><div class="line">                <span class="keyword">if</span>(e.type==<span class="string">"mouseover"</span>)&#123;</div><div class="line">                    e.target.style.setProperty(<span class="string">"color"</span>,<span class="string">"red"</span>);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    e.target.style.removeProperty(<span class="string">"color"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p> 另，event对象的eventPhase属性会返回表示事件当前阶段的值</p>
<p> <img src="index_files/5536f2e2-c453-4140-848b-d83e72bae4ce.jpg" alt=""></p>
</li>
<li>理解目标阶段<br>目标阶段是三个阶段中最简单的。当捕捉阶段完成后，事件传递到目标，触发绑定在目标上的相应事件，在目标绑定的事件上使用Event.eventPhase获取到的即为表示目标阶段的值。<br><img src="index_files/0db62014-617d-4f64-9a94-a6defc5b3597.jpg" alt=""><br>需要注意的是，如果目标绑定多个事件（使用多个addEventListener绑定多个事件），那么会指定所有的事件处理方法。如果在目标阶段调用event.stopPropagation()，相当于终止了事件流，不再进入冒泡阶段。</li>
<li><p>理解冒泡阶段<br>完成目标阶段之后，浏览器开始转而沿着上级元素链朝body元素前进。在沿途的每个元素上，浏览器都会检查是否存在针对该事件类型但没有启用捕捉的监听器（addEventListener方法第三个参数设置为false，或不设置，默认是false），如果有，则触发元素上该事件。这就是事件冒泡。下面是具体例子：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"pblock"</span>&gt;</span></div><div class="line">            哈哈哈哈，我又回来了。现在来测试下<span class="tag">&lt;<span class="name">b</span> <span class="attr">id</span>=<span class="string">"btext"</span>&gt;</span>事件捕捉阶段<span class="tag">&lt;/<span class="name">b</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> btext = <span class="built_in">document</span>.getElementById(<span class="string">"btext"</span>);</div><div class="line">            <span class="keyword">var</span> pblock = <span class="built_in">document</span>.getElementById(<span class="string">"pblock"</span>);</div><div class="line">            btext.addEventListener(<span class="string">'mouseover'</span>,handleMouseEvent);</div><div class="line">            btext.addEventListener(<span class="string">'mouseout'</span>,handleMouseEvent);</div><div class="line">            <span class="comment">//省略第三个参数,默认是false,表示冒泡阶段触发事件</span></div><div class="line">            pblock.addEventListener(<span class="string">'mouseover'</span>,handleDescendantEvent);</div><div class="line">            pblock.addEventListener(<span class="string">'mouseout'</span>,handleDescendantEvent);</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleDescendantEvent</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(e.eventPhase); <span class="comment">//值为3,表示冒泡阶段</span></div><div class="line">                <span class="comment">//只处理冒泡阶段捕捉到的子元素的事件,不处理本身事件(目标阶段事件),即鼠标悬停在p元素其他区域时不处理</span></div><div class="line">                <span class="keyword">if</span>(e.type==<span class="string">"mouseover"</span> &amp;&amp; e.eventPhase==Event.BUBBLING_PHASE)&#123;</div><div class="line">                    <span class="comment">//currentTarget表示的是当前被触发事件监听器的元素,target是事件涉及的元素(理解为直接触发事件的元素,该例鼠标悬停在b元素时才触发事件,所依target就表示b元素)</span></div><div class="line">                    e.target.style.border = <span class="string">'1px solid red'</span>;</div><div class="line">                    e.currentTarget.style.border = <span class="string">'1px solid black'</span>;</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(e.type==<span class="string">"mouseout"</span> &amp;&amp; e.eventPhase==Event.BUBBLING_PHASE)&#123;</div><div class="line">                    e.target.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                    e.currentTarget.style.removeProperty(<span class="string">"border"</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="function"><span class="keyword">function</span> <span class="title">handleMouseEvent</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(e.eventPhase); <span class="comment">//值为2,表示目标阶段</span></div><div class="line">                <span class="keyword">if</span>(e.type==<span class="string">"mouseover"</span>)&#123;</div><div class="line">                    e.target.style.setProperty(<span class="string">"color"</span>,<span class="string">"red"</span>);</div><div class="line">                &#125;<span class="keyword">else</span>&#123;</div><div class="line">                    e.target.style.removeProperty(<span class="string">"color"</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="comment">//e.stopPropagation();//目标阶段停止事件传播,则不进行冒泡阶段</span></div><div class="line">            &#125;</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p><img src="index_files/01f1aca7-c699-40d5-86a3-78864fc305e0.jpg" alt=""></p>
<p><strong>注意：并非所有事件都支持冒泡，可以用bubbles属性来检查某个事件能否冒泡</strong></p>
</li>
</ol>
</li>
<li><p>使用可撤销事件<br>  有些事件定义了一种默认行为，会在事件被触发时执行。例如，a元素被点击时默认行为是浏览器会载入href属性所指定URL的内容。当某一事件拥有默认行为时，event.cancelable属性就是true。你可以调用<code>event.preventDefault();</code>来阻止默认行为的执行。下面是例子：</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">    <span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">            <span class="keyword">var</span> aLink = <span class="built_in">document</span>.getElementsByTagName(<span class="string">"a"</span>)[<span class="number">0</span>];</div><div class="line">            aLink.addEventListener(<span class="string">'click'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">                <span class="keyword">if</span>(!confirm(<span class="string">"Do you want to visit "</span>+e.target.href+<span class="string">" ?"</span>))&#123;</div><div class="line">                    <span class="comment">//如果取消,则不访问链接</span></div><div class="line">                    e.preventDefault();</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>  <strong>注意：调用preventDefault函数不会阻止事件流经捕获、目标和冒泡阶段</strong></p>
</li>
</ul>


            <div class="post-info">
    <p class="eof">- EOF -</p>
    <p class="copyright">All rights reserved <a href="http://heji1993.github.io/about">@heji1993</a>.</p>
    <p class="link">本文链接：<a href="https://heji1993.github.io/2016/12/20/HTML-DOM教程/">https://heji1993.github.io/2016/12/20/HTML-DOM教程/</a></p>

    <div class="share">
    分享本页：
    
        <div class="bdsharebuttonbox"><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a><a href="#" class="bds_more" data-cmd="more"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

    
    
</div>

</div>


            
    <section class="comment">
    <div class="ds-thread" data-thread-key="undefined" data-title="HTML-DOM教程" data-url="https://heji1993.github.io/2016/12/20/HTML-DOM教程/" data-author-key="何机"></div>
</section>


<script type="text/javascript">
var duoshuoQuery = {short_name:"heji"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';
        ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>





        </div>
    </div>
</article>

    <footer id="footer">
        <div id="bottom-tip">
            何机的博客 —— <small>No pains,no gains</small>
        </div>
        <small>该博客由 <a href="https://hexo.io/" target="_blank">Hexo</a> 强力驱动，搭载 <a href="https://github.com/gejiawen/hexadillax2" target="_blank">Hexadillax2</a> 主题</small><br />
        <!--<small>如果你访问github速度过慢，可移步本站的备份站点<a href="http://gejiawen.gitcafe.io">gejiawen.gitcafe.io</a></small><br />-->
        <small>&copy; 2016 <a href="https://heji1993.github.io" target="_blank">何机</a></small>
    </footer>
    
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e4dd778a6204eb51e4f25460e37481ad";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=58628762" charset="UTF-8"></script>


    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-51347904-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

