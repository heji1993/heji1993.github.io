

<!DOCTYPE html>
<html lang="zh-Hans">
<head>
    
    <meta name="author" content="何机">
    
    <meta name="description" content="在本章中，我将通过添加对真实数据的支持，实现购物车并开始订单结账的过程，继续运动商店应用程序的开发。">
    
    <meta name="keywords" content="AngularJS,MVVM,前端框架, 何机的技术博客,何机,博客,blog,IT,技术">
    

    
    <link rel="alternative" href="atom.xml" title="何机的技术博客" type="application/atom+xml">
    
    
    

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>第五章、运动商店：导航和结账 | 何机的技术博客 · No pains,no gains</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/style.css">

    <!-- Javascript -->
    <script src="/js/jquery-2.1.0.min.js"></script>
    <script src="/js/jquery.backstretch.min.js"></script>
    <script src="/bootstrap/js/bootstrap.min.js"></script>
    <script src="/js/headroom.min.js"></script>
    <script src="/js/jquery.headroom.min.js"></script>
    <script src="/js/common.js"></script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    
    <meta name="baidu-site-verification" content="SzJ3MGdmeo" />


    <meta name="360-site-verification" content="afe5dc96bbb8d111b618f78493b95bb8" />


    <!--<meta name="baidu-site-verification" content="SzJ3MGdmeo" />-->
    <!--<meta name="360-site-verification" content="afe5dc96bbb8d111b618f78493b95bb8" />-->

</head>
<body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-inverse" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://heji.website" title="何机的技术博客">何机的技术博客</a>
            </div>

            <div role="navigation" class="collapse navbar-collapse bs-navbar-collapse">
                
                <ul class="nav navbar-nav pull-right">
                    <li>
                        <!--<a class="max-width max-w300" title="No pains,no gains" href="/feelings">No pains,no gains</a>-->
						<a class="max-width max-w300" title="No pains,no gains">No pains,no gains</a>
                    </li>
                </ul>
                

                <ul class="nav navbar-nav">
                    
                    <li id="nav-index">
                        <a href="/" target="">首页</a>
                    </li>
                    
                    <li id="nav-archives">
                        <a href="/archives" target="">归档</a>
                    </li>
                    
                    <li id="nav-categories">
                        <a href="/categories" target="">分类</a>
                    </li>
                    
                    <li id="nav-tags">
                        <a href="/tags" target="">标签</a>
                    </li>
                    
                    <li id="nav-about">
                        <a href="/about" target="">关于</a>
                    </li>
                    

                    <li id="nav-github"><a href="https://github.com/heji1993" target="_blank">GitHub</a></li>
                    <!--<li id="nav-rss"><a href="/atom.xml" target="_blank">Rss</a></li>-->
                    <li id="nav-search"><input type="text" id="search" placeholder="search" /></li>
                </ul>
            </div>
        </div>
    </nav>

    <script>
    var bgRoot = "http://7xkwt1.com1.z0.glb.clouddn.com/background-";
    var bgLength = "74";
    var bgRandom = false;
    var bgImage = "/images/bg.jpg";

    $(function() {
        // page-id...
        var pageId = "2017/03/06/第五章、运动商店：导航和结账/";
        pageId = pageId.substr(0, pageId.indexOf("/"));
        if(pageId === "") pageId = "index";

        $("#nav-" + pageId).addClass("active");
    });
    </script>

    <article class="post container">
    <div class="well post-body first-post last-post">
        <h1>第五章、运动商店：导航和结账</h1>

        <div class="time-info">
            
<span class="article-tags">
    
    Tags: <a href="/tags/AngularJS/">AngularJS</a>&nbsp;
</span>



<span class="article-categories">
    Category:
    <a class="article-category-link" href="/categories/AngularJS/">AngularJS</a>
</span>


        </div>
        <div class="time-info">
            发表: <time datetime="2017-03-06T06:39:25.214Z"
                       itemprop="datePublished">2017-03-06</time>
            
            更新: <time datetime="2017-03-06T06:44:44.431Z"
                       itemprop="dateModified">2017-03-06</time>
            
        </div>

        <div class="post-body-inner">
            
                <div id="toc" class="toc-article well">
                    <strong class="toc-title">大纲</strong>
                    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#使用真实数据-请先启动Deployd"><span class="toc-number">1.</span> <span class="toc-text">使用真实数据(请先启动Deployd )</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#获取数据"><span class="toc-number">1.1.</span> <span class="toc-text">获取数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#处理错误"><span class="toc-number">1.2.</span> <span class="toc-text">处理错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建局部视图"><span class="toc-number">2.</span> <span class="toc-text">创建局部视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#创建购物车"><span class="toc-number">3.</span> <span class="toc-text">创建购物车</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义购物车模块和服务"><span class="toc-number">3.1.</span> <span class="toc-text">定义购物车模块和服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#创建购物车部件"><span class="toc-number">3.2.</span> <span class="toc-text">创建购物车部件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#添加产品选择按钮"><span class="toc-number">3.3.</span> <span class="toc-text">添加产品选择按钮</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#添加URL导航"><span class="toc-number">4.</span> <span class="toc-text">添加URL导航</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#定义和使用URL路由"><span class="toc-number">4.1.</span> <span class="toc-text">定义和使用URL路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#开始结账流程"><span class="toc-number">5.</span> <span class="toc-text">开始结账流程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#小结"><span class="toc-number">6.</span> <span class="toc-text">小结</span></a></li></ol>
                </div>
            

            <p>在本章中，我将通过添加对真实数据的支持，实现购物车并开始订单结账的过程，继续运动商店应用程序的开发。</p>
<a id="more"></a>
<h2 id="使用真实数据-请先启动Deployd"><a href="#使用真实数据-请先启动Deployd" class="headerlink" title="使用真实数据(请先启动Deployd )"></a>使用真实数据(请先启动Deployd )</h2><h3 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h3><p> AngularJS通过服务<code>$http</code>提供对产生Ajax请求的支持，后续章节讲述服务的工作细节以及<code>$http</code>本身。下面是修改后的<code>controllers/sportsStore.js</code>文件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//module方法值传一个参数表示我们尝试找到sportsStore这个模块,必须先有sportsStore模块,否则会报错</span></div><div class="line">angular.module(<span class="string">"sportsStore"</span>)</div><div class="line">.constant(<span class="string">"dataUrl"</span>,<span class="string">"http://localhost:5550/products"</span>)</div><div class="line">.controller(<span class="string">"sportsStoreCtrl"</span>,[<span class="string">"$scope"</span>,<span class="string">"$http"</span>,<span class="string">"dataUrl"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,$http,dataUrl</span>)</span>&#123;</div><div class="line">	$scope.data = &#123;&#125;;</div><div class="line">	<span class="comment">//使用$http服务查询数据</span></div><div class="line">	$http.get(dataUrl)</div><div class="line">	.success(<span class="function"><span class="keyword">function</span>(<span class="params">result</span>)</span>&#123;</div><div class="line">		$scope.data.products = result;</div><div class="line">	&#125;)</div><div class="line">	.error(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">		$scope.data.error = error;</div><div class="line">	&#125;)</div><div class="line">&#125;])</div></pre></td></tr></table></figure>
<h3 id="处理错误"><a href="#处理错误" class="headerlink" title="处理错误"></a>处理错误</h3><p>当有错误时，应该在页面显示错误信息，为此，需要对<code>app.html</code>页面进行修改，下面是修改的部分代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">    &lt;header class="navbar navbar-inverse"&gt;</div><div class="line">		&lt;a href="#" class="navbar-brand"&gt;运动商店&lt;/a&gt;</div><div class="line">	&lt;/header&gt;</div><div class="line">	&lt;!--有错误时显示--&gt;</div><div class="line">	&#123;&#123;data.error.status&#125;&#125;</div><div class="line">	&lt;section class="alert alert-danger" ng-show="data.error"&gt;</div><div class="line">		Error (&#123;&#123;data.error.status&#125;&#125;).The product data was not loaded.</div><div class="line">		&lt;a href="/app.html" class="alert-link"&gt;Click here to try again&lt;/a&gt;</div><div class="line">	&lt;/section&gt;</div><div class="line">	&lt;!--没有错误时显示--&gt;</div><div class="line">	&lt;section class="panel panel-default row" ng-controller="productListCtrl" ng-hide="data.error"&gt;</div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="创建局部视图"><a href="#创建局部视图" class="headerlink" title="创建局部视图"></a>创建局部视图</h2><p>在<code>app.html</code>文件中的HTML错综复杂，随着应用程序功能的增加，情况会变得更加糟糕，幸运的是，我们可以把<code>app.html</code>拆分成多个独立的文件，然后使用AngularJS提供的<code>ng-include</code>指令在运行时引入这些文件。为了这个目的，我创建了<code>views/productList.html</code>文件，下面是该文件的内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"panel panel-default row"</span> <span class="attr">ng-controller</span>=<span class="string">"productListCtrl"</span> <span class="attr">ng-hide</span>=<span class="string">"data.error"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"col-xs-3"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">ng-click</span>=<span class="string">"selectCategory()"</span> <span class="attr">class</span>=<span class="string">"btn btn-block btn-default"</span> </span></div><div class="line">			<span class="attr">ng-class</span>=<span class="string">"getCategoryClass()"</span>&gt;Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--先对商品按目录进行排序,然后再返回去重后的目录--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">a</span> <span class="attr">ng-repeat</span>=<span class="string">"item in data.products | orderBy:'category' | unique:'category'"</span></span></div><div class="line">			<span class="attr">ng-click</span>=<span class="string">"selectCategory(item)"</span> <span class="attr">class</span>=<span class="string">"btn btn-block btn-default btn-lg"</span> </div><div class="line">			<span class="attr">ng-class</span>=<span class="string">"getCategoryClass(item)"</span>&gt;&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">nav</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-xs-8"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--遍历添加商品--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"well"</span> <span class="attr">ng-repeat</span>=<span class="string">"item in data.products | filter:categoryFilterFn | range:selectedPage:pageSize"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">h3</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></div><div class="line">				<span class="comment">&lt;!--使用金额过滤器，将数值转换为金额--&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"pull-right label label-primary"</span>&gt;</span></div><div class="line">					&#123;&#123;item.price | currency&#125;&#125;</div><div class="line">				<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"lead"</span>&gt;</span>&#123;&#123;item.description &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"pull-right btn-group"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">ng-repeat</span>=<span class="string">"page in data.products | filter:categoryFilterFn | pageCount:pageSize"</span></span></div><div class="line">				<span class="attr">ng-click</span>=<span class="string">"selectPage($index + 1)"</span> <span class="attr">class</span>=<span class="string">"btn btn-default"</span> <span class="attr">ng-class</span>=<span class="string">"getPageClass($index + 1)"</span>&gt;</div><div class="line">				&#123;&#123;$index + 1&#125;&#125;</div><div class="line">			<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>下面是<code>app.html</code>文件的内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">ng-app</span>=<span class="string">"sportsStore"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">title</span>&gt;</span>SportsStore<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"angular.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"bootstrap.css"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"bootstrap-theme.css"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">			<span class="comment">//依赖customFilter模块</span></div><div class="line">			angular.module(<span class="string">"sportsStore"</span>,[<span class="string">"customFilter"</span>]);</div><div class="line">		<span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--引入顶级控制器--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/sportsStore.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--引入自定义过滤器--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"filters/customFilters.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--引入产品列表控制器--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/productListController.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!--使用控制器--&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">body</span> <span class="attr">ng-controller</span>=<span class="string">"sportsStoreCtrl"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span>&gt;</span>运动商店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">header</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--有错误时显示--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"alert alert-danger"</span> <span class="attr">ng-show</span>=<span class="string">"data.error"</span>&gt;</span></div><div class="line">			Error (&#123;&#123;data.error.status&#125;&#125;).The product data was not loaded.</div><div class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/app.html"</span> <span class="attr">class</span>=<span class="string">"alert-link"</span>&gt;</span>Click here to try again<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">ng-include</span> <span class="attr">src</span>=<span class="string">"'views/productList.html'"</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-include</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p><strong>注意：当AngularJS遇到ng-include指令时，它会产生Ajax请求，载入src属性所指定的文件，并插入其内容以替换该元素。在使用ng-include指令时，我将文件名写成单引号的字面量。如果我不这么做，那指令会在作用域属性上寻找文件名</strong></p>
<h2 id="创建购物车"><a href="#创建购物车" class="headerlink" title="创建购物车"></a>创建购物车</h2><p>用户能看到我的有效产品，但我没有购物车就没法出售任何东西。在本段中，我将构建购物车功能，下图是它的基本流程：<br><img src="imgs/1486461273494_2.png" alt=""><br>实现购物车特性需要若干组改动，包括创建自定义的AngularJS组件。</p>
<h3 id="定义购物车模块和服务"><a href="#定义购物车模块和服务" class="headerlink" title="定义购物车模块和服务"></a>定义购物车模块和服务</h3><p>通常，我们习惯把控制器放在<code>controllers</code>目录，过滤器放在<code>filters</code>目录下，视图放在<code>views</code>目录下等。我们也可以根据具体情况，把实现某一功能的全部代码写成一个组件，为此，我定义了<code>components</code>文件夹专门存放自定义的组件。在本例中，我将创建购物车模块。我首先创建<code>components/cart</code>目录，并向其添加新的javascript文件<code>cart.js</code>，下面是<code>cart.js</code>文件的内容：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">"cart"</span>,[])</div><div class="line">.factory(<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> cartData = [];</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="comment">//添加产品</span></div><div class="line">		addProduct : <span class="function"><span class="keyword">function</span>(<span class="params">id,name,price</span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> addToExistingItem = <span class="literal">false</span>;</div><div class="line">			<span class="comment">//如果已经存在相同id的产品,只增加其数量</span></div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				<span class="keyword">if</span>(cartData[i].id == id)&#123;</div><div class="line">					cartData[i].count ++;</div><div class="line">					addToExistingItem = <span class="literal">true</span>;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(!addToExistingItem)&#123;</div><div class="line">				cartData.push(&#123;</div><div class="line">					count:<span class="number">1</span>,id:id,price:price,name:name</div><div class="line">				&#125;);</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//移除产品</span></div><div class="line">		removeProduct : <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				<span class="keyword">if</span>(cartData[i].id == id)&#123;</div><div class="line">					cartData.splice(i,<span class="number">1</span>);</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//获取所有产品</span></div><div class="line">		getProducts : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> cartData;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>我先在新模块<code>cart</code>自定义了<code>cartService</code>服务，创建服务有不同的方法，比如<code>service</code>、<code>factory</code>和<code>provider</code>，后面讲讲解它们的区别。创建服务第一个参数是服务名，第二个参数是工厂函数，在服务被注入应用于应用程序时，工厂函数只被调用一次(第一次注入时调用)。在本例中，我的cart服务工厂函数返回对象，对象有三个方法，下面是<code>cartService</code>服务所定义的方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>addProduct(id,name,price)</td>
<td>添加指定的产品到购物车，或者如果购物车以及包含该产品，就增加产品的数量</td>
</tr>
<tr>
<td>removeProduct(id)</td>
<td>删除指定ID的产品</td>
</tr>
<tr>
<td>getProducts()</td>
<td>返回购物车中所有商品</td>
</tr>
</tbody>
</table>
<h3 id="创建购物车部件"><a href="#创建购物车部件" class="headerlink" title="创建购物车部件"></a>创建购物车部件</h3><p>我下一步要创建囊括购物车内容的部件，提供给用户以开始结账流程，我将创建自定义指令来做。指令是自包含的，复用功能单元是AngularJS开发的核心。下面是我在<code>components/cart/cart.js</code>文件添加的内容：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment">//自定义cartSummary指令,依赖于cartService服务</span></div><div class="line">.directive(<span class="string">"cartSummary"</span>,[<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cartService</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		restrict : <span class="string">"E"</span>,</div><div class="line">		templateUrl : <span class="string">"components/cart/cartSummary.html"</span>,</div><div class="line">		controller : [<span class="string">"$scope"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> cartData = cartService.getProducts();</div><div class="line">			<span class="comment">//计算购物车商品总价</span></div><div class="line">			$scope.total = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">var</span> total = <span class="number">0</span>;</div><div class="line">				<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">					total += (cartData[i].count * cartData[i].price);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">return</span> total;</div><div class="line">			&#125;</div><div class="line">			<span class="comment">//计算购物车商品总数</span></div><div class="line">			$scope.itemCount = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">				<span class="keyword">var</span> total = <span class="number">0</span>;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">					total += cartData[i].count;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">return</span> total;</div><div class="line">			&#125;</div><div class="line">		&#125;]</div><div class="line">	&#125;</div><div class="line">&#125;]);</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>指令由AngularJS模块上的 directive方法创建，第一个参数是指令名（驼峰式命名），第二个参数是返回指令释义对象的工厂函数。指令释义对象定义属性告诉AngularJS你的指令做什么和如何做。我在定义cartSummary指令时指定了三个属性，下面是三个属性的说明（后续章节讲解并演示整套属性）</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>restrict</td>
<td>指定指令如果应用，E值表示指令只能作为元素使用，A值表示指令只能作为属性使用，EA表示指令可作为元素或属性使用</td>
</tr>
<tr>
<td>templateUrl</td>
<td>指定将被插入指令的元素内容的局部视图</td>
</tr>
<tr>
<td>controller</td>
<td>指定向局部视图提供数据和行为的控制器</td>
</tr>
</tbody>
</table>
<p>简单地说，我的指令释义定义了控制器，告诉AngularJS使用<code>components/cart/cartSummary.html</code>视图，还有约束指令，让其可以仅作为元素而被使用。<br>另外，因为我使用了<code>cartService</code>服务，需要注入服务。我又在指令的控制器定义了两个行为<code>total</code>和<code>itemCount</code>，这让我可以直接在局部视图内使用这些行为。下面是<code>components/cart/cartSummary.html</code>文件的内容：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;style type="text/css"&gt;</div><div class="line">	.navbar-right&#123;</div><div class="line">		float: right !important;</div><div class="line">		margin-right: 5px; </div><div class="line">	&#125;</div><div class="line">	.navbar-text&#123;</div><div class="line">		margin-right: 10px;</div><div class="line">	&#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;div class="navbar-right"&gt;</div><div class="line">	&lt;div class="navbar-text"&gt;</div><div class="line">		&lt;b&gt;Your cart:&lt;/b&gt;</div><div class="line">		&#123;&#123;itemCount()&#125;&#125; item(s),</div><div class="line">		&#123;&#123;total() | currency&#125;&#125;</div><div class="line">	&lt;/div&gt;</div><div class="line">	&lt;!--按钮功能后面实现--&gt;</div><div class="line">	&lt;a href="#" class="btn btn-default navbar-btn"&gt;Checkout&lt;/a&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>下面在<code>app.html</code>应用模块：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="comment">//依赖customFilter模块</span></div><div class="line">	angular.module(<span class="string">"sportsStore"</span>,[<span class="string">"customFilter"</span>,<span class="string">"cart"</span>]);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入顶级控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/sportsStore.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入自定义过滤器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"filters/customFilters.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入产品列表控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/productListController.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入购物车模块--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"components/cart/cart.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">"navbar navbar-inverse"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span> <span class="attr">class</span>=<span class="string">"navbar-brand"</span>&gt;</span>运动商店<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">cart-summary</span>&gt;</span><span class="tag">&lt;/<span class="name">cart-summary</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h3 id="添加产品选择按钮"><a href="#添加产品选择按钮" class="headerlink" title="添加产品选择按钮"></a>添加产品选择按钮</h3><p>我下一步是在产品详情添加按钮，让用户可以添加产品到购物车，下面是我对<code>controllers/productListController.js</code>文件所做的修改：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment">//控制器注入cartService模块</span></div><div class="line">.controller(<span class="string">"productListCtrl"</span>,[<span class="string">"$scope"</span>,<span class="string">"$filter"</span>,<span class="string">"productListActiveClass"</span>,<span class="string">"productListPageCount"</span>,<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,$filter,productListActiveClass,productListPageCount,cartService</span>)</span>&#123;</div><div class="line">    ...</div><div class="line">    <span class="comment">//往购物车添加商品</span></div><div class="line">	$scope.addProductToCart = <span class="function"><span class="keyword">function</span>(<span class="params">product</span>)</span>&#123;</div><div class="line">		cartService.addProduct(product.id,product.name,product.price);</div><div class="line">	&#125;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>我声明了对<code>cartService</code>的依赖，并定义了行为<code>addProductToCart</code>用于往购物车添加商品。<br>然后，往局部视图<code>views/productList.html</code>添加按钮调用<code>addProductToCart</code>行为：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment">&lt;!--遍历添加商品--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"well"</span> <span class="attr">ng-repeat</span>=<span class="string">"item in data.products | filter:categoryFilterFn | range:selectedPage:pageSize"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">h3</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">strong</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!--使用金额过滤器，将数值转换为金额--&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"pull-right label label-primary"</span>&gt;</span></div><div class="line">			&#123;&#123;item.price | currency&#125;&#125;</div><div class="line">		<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!--产品选择按钮--&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-success pull-right"</span> <span class="attr">ng-click</span>=<span class="string">"addProductToCart(item)"</span>&gt;</span>Add to cart<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"lead"</span>&gt;</span>&#123;&#123;item.description &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>现在，你可以往购物车添加商品并自动计算购物车商品的数量和总价。</p>
<h2 id="添加URL导航"><a href="#添加URL导航" class="headerlink" title="添加URL导航"></a>添加URL导航</h2><p>在添加结账功能的支持之前，我要加强运动商店应用程序的基础设施，添加URL路由的支持。我会在后续章节详细介绍路由，简单地说，路由可以基于当前的URL自动地显示不同的局部视图。这使得它更易于建立更大的应用程序。<br>为实现路由功能，我先创建结账页面的局部视图，因为还没开始开阿发结账流程，所以局部视图只包含简单的占位符。下面是<code>views/checkoutSunmary.html</code>页面的内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"lead"</span>&gt;</span></div><div class="line">	This is the checkout summary view</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/products"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="定义和使用URL路由"><a href="#定义和使用URL路由" class="headerlink" title="定义和使用URL路由"></a>定义和使用URL路由</h3><p>现在，我需要分别映射<code>/product</code>和<code>/checkout</code>到<code>productList.html</code>页面和<code>checkoutSummary.html</code>页面，其他的URL都默认映射到<code>productList.html</code>页面，下面是<code>app.html</code>文件的改动:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="comment">//依赖customFilter模块、cart模块和ngRoute模块</span></div><div class="line">	angular.module(<span class="string">"sportsStore"</span>,[<span class="string">"customFilter"</span>,<span class="string">"cart"</span>,<span class="string">"ngRoute"</span>])</div><div class="line">	<span class="comment">//配置路由</span></div><div class="line">	.config([<span class="string">"$routeProvider"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$routeProvider</span>)</span>&#123;</div><div class="line">		$routeProvider.when(<span class="string">"/checkout"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/checkoutSunmary.html"</span></div><div class="line">		&#125;)</div><div class="line">		.when(<span class="string">"/pruducts"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/productList.html"</span></div><div class="line">		&#125;)</div><div class="line">		.otherwise(&#123;</div><div class="line">			templateUrl:<span class="string">"views/productList.html"</span></div><div class="line">		&#125;);</div><div class="line">	&#125;]);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入顶级控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/sportsStore.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入自定义过滤器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"filters/customFilters.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入产品列表控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/productListController.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入购物车模块--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"components/cart/cart.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入路由模块--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ngmodules/angular-route.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">...</div><div class="line"><span class="comment">&lt;!--有错误时显示--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"alert alert-danger"</span> <span class="attr">ng-show</span>=<span class="string">"data.error"</span>&gt;</span></div><div class="line">	出现错误 (&#123;&#123;data.error.status&#125;&#125;).商品的数据不能加载.</div><div class="line">	<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/app.html"</span> <span class="attr">class</span>=<span class="string">"alert-link"</span>&gt;</span>点击这里再次尝试<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">ng-view</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-view</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>在<code>cartSummary.html</code>页面点击结账按钮需要跳转到结账页面，为此，需要对<code>components/cart/cartSummary.html</code>进行跳转：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="comment">&lt;!--按钮功能后面实现--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/checkout"</span> <span class="attr">class</span>=<span class="string">"btn btn-default navbar-btn"</span>&gt;</span>back<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h2 id="开始结账流程"><a href="#开始结账流程" class="headerlink" title="开始结账流程"></a>开始结账流程</h2><p>现在，我将转向结账流程。我的第一个任务是定义新的控制器<code>cartSummaryCtrl</code>，我把它放在<code>controllers/checkoutController.js</code>文件。因为cartSummary指令需要使用计算总价和商品数量的行为，<code>cartSummaryCtrl</code>也需要使用计算总价行为，为此，我修改<code>components/cart/cart.js</code>文件，把这些行为定义在<code>cartService</code>内，下面是修改后的<code>components/cart/cart.js</code>文件：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">"cart"</span>,[])</div><div class="line">.factory(<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> cartData = [];</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="comment">//添加产品</span></div><div class="line">		addProduct : <span class="function"><span class="keyword">function</span>(<span class="params">id,name,price</span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> addToExistingItem = <span class="literal">false</span>;</div><div class="line">			<span class="comment">//如果已经存在相同id的产品,只增加其数量</span></div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				<span class="keyword">if</span>(cartData[i].id == id)&#123;</div><div class="line">					cartData[i].count ++;</div><div class="line">					addToExistingItem = <span class="literal">true</span>;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">if</span>(!addToExistingItem)&#123;</div><div class="line">				cartData.push(&#123;</div><div class="line">					count:<span class="number">1</span>,id:id,price:price,name:name</div><div class="line">				&#125;);</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//移除产品</span></div><div class="line">		removeProduct : <span class="function"><span class="keyword">function</span>(<span class="params">id</span>)</span>&#123;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				<span class="keyword">if</span>(cartData[i].id == id)&#123;</div><div class="line">					cartData.slice(i,<span class="number">1</span>);</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//获取所有产品</span></div><div class="line">		getProducts : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">return</span> cartData;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//计算购物车商品总价</span></div><div class="line">		total : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> total = <span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				total += (cartData[i].count * cartData[i].price);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> total;</div><div class="line">		&#125;,</div><div class="line">		<span class="comment">//计算购物车商品总数</span></div><div class="line">		itemCount : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> total = <span class="number">0</span>;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; cartData.length ; i++)&#123;</div><div class="line">				total += cartData[i].count;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> total;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">//自定义cartSummary指令,依赖于cartService服务</span></div><div class="line">.directive(<span class="string">"cartSummary"</span>,[<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">cartService</span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		restrict : <span class="string">"E"</span>,</div><div class="line">		templateUrl : <span class="string">"components/cart/cartSummary.html"</span>,</div><div class="line">		controller : [<span class="string">"$scope"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope</span>)</span>&#123;</div><div class="line">			<span class="keyword">var</span> cartData = cartService.getProducts();</div><div class="line">			<span class="comment">//计算购物车商品总价</span></div><div class="line">			$scope.total = cartService.total;</div><div class="line">			<span class="comment">//计算购物车商品总数</span></div><div class="line">			$scope.itemCount = cartService.itemCount;</div><div class="line">		&#125;]</div><div class="line">	&#125;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>下面是<code>controllers/checkoutController.js</code>文件的内容：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">angular.module(<span class="string">"sportsStore"</span>)</div><div class="line">.controller(<span class="string">"cartSummaryCtrl"</span>,[<span class="string">"$scope"</span>,<span class="string">"cartService"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$scope,cartService</span>)</span>&#123;</div><div class="line">	<span class="comment">//获取购物车所有商品</span></div><div class="line">	$scope.cartData = cartService.getProducts();</div><div class="line">	<span class="comment">//计算商品总价</span></div><div class="line">	$scope.total = cartService.total;</div><div class="line">	<span class="comment">//移除商品</span></div><div class="line">	$scope.remove = cartService.removeProduct;</div><div class="line">&#125;]);</div></pre></td></tr></table></figure></p>
<p>为应用控制器，实现结账流程，我需要对<code>views/checkoutSunmary.html</code>文件进行修改，下面是修改后的内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>我的购物车<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">"cartSummaryCtrl"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"alert alert-warning"</span> <span class="attr">ng-show</span>=<span class="string">"cartData.length == 0"</span>&gt;</span></div><div class="line">		你的购物车没有商品，点击<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/products"</span> <span class="attr">class</span>=<span class="string">"alert-link"</span>&gt;</span>这里<span class="tag">&lt;/<span class="name">a</span>&gt;</span>返回购物。</div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-hide</span>=<span class="string">"cartData.length == 0"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">thead</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>数量<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">th</span>&gt;</span>商品名称<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>商品单价<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">th</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>商品总价<span class="tag">&lt;/<span class="name">th</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">thead</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tbody</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">tr</span> <span class="attr">ng-repeat</span>=<span class="string">"item in cartData"</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span>&#123;&#123;item.count&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-left"</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>&#123;&#123;item.price | currency&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>&#123;&#123;(item.price * item.count) | currency&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">						<span class="tag">&lt;<span class="name">button</span> <span class="attr">ng-click</span>=<span class="string">"remove(item.id)"</span> <span class="attr">class</span>=<span class="string">"btn btn-sm btn-warning"</span>&gt;</span>移除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">					<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tfoot</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">"4"</span> <span class="attr">class</span>=<span class="string">"text-right"</span>&gt;</span>总计：<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">					<span class="tag">&lt;<span class="name">td</span> <span class="attr">class</span>=<span class="string">"text-left"</span>&gt;</span></div><div class="line">						&#123;&#123;total() | currency&#125;&#125;</div><div class="line">					<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">				<span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">			<span class="tag">&lt;/<span class="name">tfoot</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"text-center"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/products"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>继续购物<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#/placeorder"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span>&gt;</span>支付<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">div</span>&gt;</span>	</div><div class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>接着，我需要在<code>app.html</code>引入控制器并添加支付路由、感谢页面路由，这两个页面我在接下来的章节会补充，下面是<code>app.html</code>修改的内容：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></span></div><div class="line">	<span class="comment">//依赖customFilter模块、cart模块和ngRoute模块</span></div><div class="line">	angular.module(<span class="string">"sportsStore"</span>,[<span class="string">"customFilter"</span>,<span class="string">"cart"</span>,<span class="string">"ngRoute"</span>])</div><div class="line">	<span class="comment">//配置路由</span></div><div class="line">	.config([<span class="string">"$routeProvider"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">$routeProvider</span>)</span>&#123;</div><div class="line">		$routeProvider.when(<span class="string">"/checkout"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/checkoutSunmary.html"</span></div><div class="line">		&#125;)</div><div class="line">		.when(<span class="string">"/placeorder"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/placeorder.html"</span></div><div class="line">		&#125;)</div><div class="line">		.when(<span class="string">"/complete"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/thankYou.html"</span></div><div class="line">		&#125;)</div><div class="line">		.when(<span class="string">"/pruducts"</span>,&#123;</div><div class="line">			templateUrl:<span class="string">"views/productList.html"</span></div><div class="line">		&#125;)</div><div class="line">		.otherwise(&#123;</div><div class="line">			templateUrl:<span class="string">"views/productList.html"</span></div><div class="line">		&#125;);</div><div class="line">	&#125;]);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入顶级控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/sportsStore.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入自定义过滤器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"filters/customFilters.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入产品列表控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/productListController.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入购物车模块--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"components/cart/cart.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入路由模块--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"ngmodules/angular-route.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="comment">&lt;!--引入结账控制器--&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"controllers/checkoutController.js"</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>在本章中，我继续了运动商店应用程序的开发，从Deployd服务器获取产品数据，添加局部视图的支持，以及实现自定义指令，我还设置了URL路由并添加允许用户下单的功能。在下一章，我将完成运动商店应用程序并添加管理系统的支持。</p>


            <div class="post-info">
    <p class="link">本文链接：<a href="http://heji.website/2017/03/06/第五章、运动商店：导航和结账/">http://heji.website/2017/03/06/第五章、运动商店：导航和结账/</a></p>
    <div class="share">
    分享本页：
    
        <div class="bdsharebuttonbox"><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信">微信</a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间">QQ空间</a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博">新浪微博</a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博">腾讯微博</a><a href="#" class="bds_more" data-cmd="more"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{"bdSize":16}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

    
    
</div>

</div>


            
    <section class="comment">
    <div class="ds-thread" data-thread-key="undefined" data-title="第五章、运动商店：导航和结账" data-url="http://heji.website/2017/03/06/第五章、运动商店：导航和结账/" data-author-key="何机"></div>
</section>


<script type="text/javascript">
var duoshuoQuery = {short_name:"heji"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';
        ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>





        </div>
    </div>
</article>

    <footer id="footer">
        <div id="bottom-tip">
            何机的技术博客 —— <small>No pains,no gains</small>
        </div>
        <small>该博客由 <a href="https://hexo.io/" target="_blank">Hexo</a> 强力驱动，搭载 <a href="https://github.com/gejiawen/hexadillax2" target="_blank">Hexadillax2</a> 主题</small><br />
        <!--<small>如果你访问github速度过慢，可移步本站的备份站点<a href="http://gejiawen.gitcafe.io">gejiawen.gitcafe.io</a></small><br />-->
        <small>&copy; 2017 <a href="http://heji.website" target="_blank">何机</a></small>
    </footer>
    
    <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e4dd778a6204eb51e4f25460e37481ad";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=58628762" charset="UTF-8"></script>


    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-51347904-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>

